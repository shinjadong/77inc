{
  "name": "ì¹ ì¹ ê¸°ì—… ë²•ì¸ì¹´ë“œ ìë™ë¶„ë¥˜",
  "nodes": [
    {
      "parameters": {},
      "id": "trigger",
      "name": "ìˆ˜ë™ ì‹¤í–‰",
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [250, 300]
    },
    {
      "parameters": {
        "command": "cd /home/tlswk/77corp && source venv/bin/activate && python scripts/main.py \"/home/tlswk/77corp/ì¹´ë“œ/\" --json-output --sync-sheets 2>&1"
      },
      "id": "execute",
      "name": "ì¹´ë“œ ë¶„ë¥˜ ì‹¤í–‰",
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [450, 300]
    },
    {
      "parameters": {
        "jsCode": "// JSON ì¶œë ¥ íŒŒì‹±\nconst output = $input.first().json.stdout;\nconst jsonMatch = output.match(/--- JSON OUTPUT ---\\n([\\s\\S]*?)$/m);\n\nif (jsonMatch) {\n  const result = JSON.parse(jsonMatch[1]);\n  return [{\n    json: {\n      success: result.success,\n      processed: result.stats.processed,\n      duplicates: result.stats.duplicates,\n      manual_count: result.manual_count,\n      pending_file: result.pending_file,\n      message: `ì²˜ë¦¬: ${result.stats.processed}ê±´, ì¤‘ë³µ: ${result.stats.duplicates}ê±´, ë¯¸ë¶„ë¥˜: ${result.manual_count}ê±´`\n    }\n  }];\n}\n\nreturn [{ json: { success: false, error: 'JSON íŒŒì‹± ì‹¤íŒ¨' } }];"
      },
      "id": "parse",
      "name": "ê²°ê³¼ íŒŒì‹±",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [650, 300]
    },
    {
      "parameters": {
        "conditions": {
          "number": [
            {
              "value1": "={{ $json.manual_count }}",
              "operation": "larger",
              "value2": 0
            }
          ]
        }
      },
      "id": "check_manual",
      "name": "ë¯¸ë¶„ë¥˜ ì²´í¬",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [850, 300]
    },
    {
      "parameters": {
        "message": "=### ë²•ì¸ì¹´ë“œ ìë™ë¶„ë¥˜ ì™„ë£Œ\n\n{{ $json.message }}\n\nâœ… êµ¬ê¸€ ì‹œíŠ¸ ë™ê¸°í™” ì™„ë£Œ"
      },
      "id": "notify_success",
      "name": "ì™„ë£Œ ì•Œë¦¼",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3,
      "position": [1050, 200]
    },
    {
      "parameters": {
        "message": "=### âš ï¸ ë¯¸ë¶„ë¥˜ í•­ëª© ë°œìƒ\n\n{{ $json.message }}\n\nğŸ“‹ ë¯¸ë¶„ë¥˜ íŒŒì¼: {{ $json.pending_file }}\n\n'ìµœì¢…_ì‚¬ìš©ìš©ë„' ì»¬ëŸ¼ì— ì…ë ¥ í›„ learn_patterns.py ì‹¤í–‰ í•„ìš”"
      },
      "id": "notify_manual",
      "name": "ë¯¸ë¶„ë¥˜ ì•Œë¦¼",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3,
      "position": [1050, 400]
    }
  ],
  "connections": {
    "ìˆ˜ë™ ì‹¤í–‰": {
      "main": [[{"node": "ì¹´ë“œ ë¶„ë¥˜ ì‹¤í–‰", "type": "main", "index": 0}]]
    },
    "ì¹´ë“œ ë¶„ë¥˜ ì‹¤í–‰": {
      "main": [[{"node": "ê²°ê³¼ íŒŒì‹±", "type": "main", "index": 0}]]
    },
    "ê²°ê³¼ íŒŒì‹±": {
      "main": [[{"node": "ë¯¸ë¶„ë¥˜ ì²´í¬", "type": "main", "index": 0}]]
    },
    "ë¯¸ë¶„ë¥˜ ì²´í¬": {
      "main": [
        [{"node": "ì™„ë£Œ ì•Œë¦¼", "type": "main", "index": 0}],
        [{"node": "ë¯¸ë¶„ë¥˜ ì•Œë¦¼", "type": "main", "index": 0}]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  }
}
