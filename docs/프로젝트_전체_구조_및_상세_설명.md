# ì¹ ì¹ ê¸°ì—… ë²•ì¸ì¹´ë“œ ê´€ë¦¬ ì‹œìŠ¤í…œ - ì „ì²´ êµ¬ì¡° ë° ìƒì„¸ ì„¤ëª…

> **ì‘ì„±ì¼**: 2025-01-16
> **ë²„ì „**: v3.1.1
> **ëª©ì **: í”„ë¡œì íŠ¸ì˜ ëª¨ë“  êµ¬ì¡°ì™€ ë™ì‘ ì›ë¦¬ë¥¼ ìƒì„¸íˆ ë¬¸ì„œí™”í•˜ì—¬ ì»¨í…ìŠ¤íŠ¸ë¥¼ ë³´ì¡´

---

## ğŸ“š ëª©ì°¨

1. [í”„ë¡œì íŠ¸ ê°œìš”](#1-í”„ë¡œì íŠ¸-ê°œìš”)
2. [ê¸°ìˆ  ìŠ¤íƒ ìƒì„¸](#2-ê¸°ìˆ -ìŠ¤íƒ-ìƒì„¸)
3. [ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ](#3-ë°ì´í„°ë² ì´ìŠ¤-ìŠ¤í‚¤ë§ˆ)
4. [í”„ë¡œì íŠ¸ êµ¬ì¡° ìƒì„¸](#4-í”„ë¡œì íŠ¸-êµ¬ì¡°-ìƒì„¸)
5. [í•µì‹¬ ê¸°ëŠ¥ ìƒì„¸](#5-í•µì‹¬-ê¸°ëŠ¥-ìƒì„¸)
6. [ì»´í¬ë„ŒíŠ¸ ë¶„ì„](#6-ì»´í¬ë„ŒíŠ¸-ë¶„ì„)
7. [ë°ì´í„° íë¦„](#7-ë°ì´í„°-íë¦„)
8. [íŒ¨í„´ ë§¤ì¹­ ì‹œìŠ¤í…œ](#8-íŒ¨í„´-ë§¤ì¹­-ì‹œìŠ¤í…œ)
9. [ì„¸ê¸ˆ ë¶„ë¥˜ ì‹œìŠ¤í…œ](#9-ì„¸ê¸ˆ-ë¶„ë¥˜-ì‹œìŠ¤í…œ)
10. [AI í†µí•© êµ¬ì¡°](#10-ai-í†µí•©-êµ¬ì¡°)
11. [ë°°í¬ ë° í™˜ê²½ì„¤ì •](#11-ë°°í¬-ë°-í™˜ê²½ì„¤ì •)
12. [ê°œë°œ íˆìŠ¤í† ë¦¬](#12-ê°œë°œ-íˆìŠ¤í† ë¦¬)

---

## 1. í”„ë¡œì íŠ¸ ê°œìš”

### 1.1 ë¹„ì¦ˆë‹ˆìŠ¤ ëª©ì 

ë²•ì¸ì¹´ë“œ ì²­êµ¬ ëª…ì„¸ì„œë¥¼ ì—…ë¡œë“œí•˜ë©´ ìë™ìœ¼ë¡œ ê±°ë˜ ë‚´ì—­ì„ íŒŒì‹±í•˜ê³ , 4ë‹¨ê³„ íŒ¨í„´ ë§¤ì¹­ ì‹œìŠ¤í…œì„ í†µí•´ "ì‚¬ìš©ë‚´ì—­"ì„ ìë™ìœ¼ë¡œ ë§¤ì¹­í•©ë‹ˆë‹¤. AI ì–´ì‹œìŠ¤í„´íŠ¸ì™€ ëŒ€í™”í˜•ìœ¼ë¡œ ê±°ë˜ë¥¼ ê´€ë¦¬í•˜ê³ , ì—‘ì…€ë¡œ ë‚´ë³´ë‚´ê¸°í•˜ì—¬ ì„¸ë¬´ì‚¬ì—ê²Œ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 1.2 í•µì‹¬ ê°€ì¹˜

1. **ì‹œê°„ ì ˆì•½**: ìˆ˜ë™ ì…ë ¥ ëŒ€ë¹„ 90% ì´ìƒ ì‹œê°„ ì ˆì•½
2. **ì •í™•ë„ í–¥ìƒ**: íŒ¨í„´ í•™ìŠµìœ¼ë¡œ ë§¤ì¹­ ì •í™•ë„ ì§€ì†ì  í–¥ìƒ
3. **ë‚´ë¶€ ê´€ë¦¬ ê°•í™”**: ì¶”ê°€ë©”ëª¨ ê¸°ëŠ¥ìœ¼ë¡œ ì„¸ë¬´ì‚¬ ì†Œí†µ ìµœì†Œí™”
4. **ì„¸ê¸ˆ ë¶„ë¥˜ ìë™í™”**: 11ê°œ ì¹´í…Œê³ ë¦¬ ë£° ê¸°ë°˜ ìë™ ë¶„ë¥˜
5. **AI ì§€ì›**: ìì—°ì–´ë¡œ ê±°ë˜ ì¡°íšŒ ë° íŒ¨í„´ ë§¤ì¹­ ìš”ì²­

### 1.3 ì‚¬ìš©ì ì›Œí¬í”Œë¡œìš°

```
1. ì¹´ë“œì‚¬ ëª…ì„¸ì„œ XLSX ì—…ë¡œë“œ
   â†“
2. ìë™ íŒŒì‹± ë° ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥
   â†“
3. 4ë‹¨ê³„ íŒ¨í„´ ë§¤ì¹­ ìë™ ì‹¤í–‰
   â†“
4. ë¯¸ë§¤ì¹­ ê±°ë˜ ìˆ˜ë™ ì…ë ¥ (ì¶”ê°€ë©”ëª¨, ì„¸ê¸ˆë¶„ë¥˜ ì„ íƒ)
   â†“
5. íŒ¨í„´ìœ¼ë¡œ ì €ì¥ (ë‹¤ìŒ ë§¤ì¹­ ì‹œ ìë™ ì ìš©)
   â†“
6. ì—‘ì…€ ë‚´ë³´ë‚´ê¸° (6ì»¬ëŸ¼: ê²°ì œì¼ì, ê°€ë§¹ì ëª…, ì´ìš©ê¸ˆì•¡, ì‚¬ìš©ìš©ë„, ì¶”ê°€ë©”ëª¨, ì„¸ê¸ˆë¶„ë¥˜)
```

---

## 2. ê¸°ìˆ  ìŠ¤íƒ ìƒì„¸

### 2.1 í”„ë¡ íŠ¸ì—”ë“œ

| ê¸°ìˆ  | ë²„ì „ | ìš©ë„ | ì„ íƒ ì´ìœ  |
|------|------|------|-----------|
| **Next.js** | 16.1.1 | í”„ë ˆì„ì›Œí¬ | App Router, Turbopack, SSR/SSG ì§€ì› |
| **React** | 19 | UI ë¼ì´ë¸ŒëŸ¬ë¦¬ | ì»´í¬ë„ŒíŠ¸ ê¸°ë°˜, í’ë¶€í•œ ìƒíƒœê³„ |
| **TypeScript** | 5.7 | íƒ€ì… ì‹œìŠ¤í…œ | íƒ€ì… ì•ˆì •ì„±, ìë™ì™„ì„± |
| **Tailwind CSS** | 3.4 | ìŠ¤íƒ€ì¼ë§ | ìœ í‹¸ë¦¬í‹° ìš°ì„ , ë¹ ë¥¸ ê°œë°œ |
| **React Query (TanStack Query)** | 5.62 | ë°ì´í„° í˜ì¹­ | ìºì‹±, ë¦¬í˜ì¹­, ìƒíƒœ ê´€ë¦¬ |
| **Vercel AI SDK** | 4.1 | AI í†µí•© | ë©€í‹° í”„ë¡œë°”ì´ë” ì§€ì›, ìŠ¤íŠ¸ë¦¬ë° |
| **ExcelJS** | 4.4 | ì—‘ì…€ ì²˜ë¦¬ | ì½ê¸°/ì“°ê¸°, ìŠ¤íƒ€ì¼ë§ |
| **Lucide React** | 0.469 | ì•„ì´ì½˜ | ê¹”ë”í•œ ë””ìì¸, íŠ¸ë¦¬ì‰ì´í‚¹ |
| **date-fns** | 4.1 | ë‚ ì§œ ì²˜ë¦¬ | ê°€ë³ê³  ë¹ ë¦„ |
| **Recharts** | 2.15 | ì°¨íŠ¸ | React ë„¤ì´í‹°ë¸Œ, ì„ ì–¸ì  |

### 2.2 ë°±ì—”ë“œ

| ê¸°ìˆ  | ë²„ì „ | ìš©ë„ | ì„ íƒ ì´ìœ  |
|------|------|------|-----------|
| **Supabase** | - | BaaS | PostgreSQL, Auth, Storage í†µí•© |
| **PostgreSQL** | 15 | ë°ì´í„°ë² ì´ìŠ¤ | JSONB, RLS, í’ë¶€í•œ ê¸°ëŠ¥ |
| **Edge Functions** | - | ì„œë²„ë¦¬ìŠ¤ | ë¹ ë¥¸ ì‘ë‹µ, ìë™ ìŠ¤ì¼€ì¼ë§ |

### 2.3 AI í”„ë¡œë°”ì´ë”

| í”„ë¡œë°”ì´ë” | ëª¨ë¸ | ê°€ê²© (1M í† í°) | íŠ¹ì§• |
|-----------|------|----------------|------|
| **DeepSeek** (ê¸°ë³¸) | deepseek-chat | ì…ë ¥ $0.28 / ì¶œë ¥ $0.42 | ê°€ì¥ ì €ë ´, í•©ë¦¬ì  ì„±ëŠ¥ |
| OpenAI | gpt-4o | ì…ë ¥ $2.50 / ì¶œë ¥ $10.00 | ë©€í‹°ëª¨ë‹¬, ë†’ì€ ì •í™•ë„ |
| Anthropic | claude-sonnet-4-20250514 | ì…ë ¥ $3.00 / ì¶œë ¥ $15.00 | ê¸´ ì»¨í…ìŠ¤íŠ¸, ì¶”ë¡  ëŠ¥ë ¥ |
| OpenRouter | 400+ ëª¨ë¸ | ë‹¤ì–‘ | ë©€í‹° í”„ë¡œë°”ì´ë” í†µí•© |

### 2.4 ë°°í¬ ë° ì¸í”„ë¼

| ì„œë¹„ìŠ¤ | ìš©ë„ | ë¹„ê³  |
|--------|------|------|
| **Vercel** | í”„ë¡ íŠ¸ì—”ë“œ í˜¸ìŠ¤íŒ… | GitHub ì—°ë™, ìë™ ë°°í¬ |
| **Supabase Cloud** | ë°ì´í„°ë² ì´ìŠ¤ í˜¸ìŠ¤íŒ… | ìë™ ë°±ì—…, ëª¨ë‹ˆí„°ë§ |
| **GitHub** | ë²„ì „ ê´€ë¦¬ | Git, CI/CD |

---

## 3. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

### 3.1 í…Œì´ë¸” êµ¬ì¡°

#### 3.1.1 `users` í…Œì´ë¸”

ì‚¬ìš©ì(ì§ì›) ì •ë³´ë¥¼ ì €ì¥í•©ë‹ˆë‹¤.

```sql
CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  name VARCHAR(100) NOT NULL,
  email VARCHAR(255),
  phone VARCHAR(20),
  department VARCHAR(100),
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

| ì»¬ëŸ¼ | íƒ€ì… | ì„¤ëª… | ì˜ˆì‹œ |
|------|------|------|------|
| id | SERIAL | ê³ ìœ  ì‹ë³„ì | 1, 2, 3... |
| name | VARCHAR(100) | ì‚¬ìš©ì ì´ë¦„ | "ê¹€ì¤€êµ", "ê¹€ìš©ì„" |
| email | VARCHAR(255) | ì´ë©”ì¼ (ì„ íƒ) | "user@example.com" |
| phone | VARCHAR(20) | ì „í™”ë²ˆí˜¸ (ì„ íƒ) | "010-1234-5678" |
| department | VARCHAR(100) | ë¶€ì„œ (ì„ íƒ) | "ê²½ì˜ì§€ì›íŒ€" |
| is_active | BOOLEAN | í™œì„±í™” ì—¬ë¶€ | true, false |
| created_at | TIMESTAMP | ìƒì„±ì¼ì‹œ | 2025-01-01 10:00:00 |
| updated_at | TIMESTAMP | ìˆ˜ì •ì¼ì‹œ | 2025-01-15 14:30:00 |

#### 3.1.2 `cards` í…Œì´ë¸”

ë²•ì¸ì¹´ë“œ ì •ë³´ë¥¼ ì €ì¥í•©ë‹ˆë‹¤.

```sql
CREATE TABLE cards (
  id SERIAL PRIMARY KEY,
  card_number VARCHAR(4) NOT NULL UNIQUE,
  user_id INTEGER REFERENCES users(id),
  card_name VARCHAR(100),
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMP DEFAULT NOW()
);
```

| ì»¬ëŸ¼ | íƒ€ì… | ì„¤ëª… | ì˜ˆì‹œ |
|------|------|------|------|
| id | SERIAL | ê³ ìœ  ì‹ë³„ì | 1, 2, 3... |
| card_number | VARCHAR(4) | ì¹´ë“œ ë’¤ 4ìë¦¬ | "3987", "9904" |
| user_id | INTEGER | ì‚¬ìš©ì FK | 1 (ê¹€ì¤€êµ) |
| card_name | VARCHAR(100) | ì¹´ë“œ ë³„ì¹­ | "ê¹€ì¤€êµ ë²•ì¸ì¹´ë“œ" |
| is_active | BOOLEAN | í™œì„±í™” ì—¬ë¶€ | true, false |
| created_at | TIMESTAMP | ìƒì„±ì¼ì‹œ | 2025-01-01 10:00:00 |

**ë“±ë¡ëœ ì¹´ë“œ ëª©ë¡ (2025-01-16 ê¸°ì¤€)**:
- 3987 (ê¹€ì¤€êµ)
- 4985 (ê¹€ìš©ì„ ëŒ€í‘œë‹˜)
- 6902 (í•˜ì´íŒ¨ìŠ¤1)
- 6911 (í•˜ì´íŒ¨ìŠ¤2)
- 6974 (ë…¸í˜œê²½ ì´ì‚¬ë‹˜)
- 9980 (ê³µìš©ì¹´ë“œ)
- 0981 (ë²•ì¸ì¹´ë“œ 0981)
- 9904 (ë²•ì¸ì¹´ë“œ 9904)

#### 3.1.3 `transactions` í…Œì´ë¸”

ì¹´ë“œ ê±°ë˜ ë‚´ì—­ì„ ì €ì¥í•©ë‹ˆë‹¤. **v3.1ì—ì„œ ì¶”ê°€ë©”ëª¨, ì„¸ê¸ˆë¶„ë¥˜ í•„ë“œ ì¶”ê°€**.

```sql
CREATE TABLE transactions (
  id SERIAL PRIMARY KEY,
  session_id INTEGER REFERENCES sessions(id) ON DELETE CASCADE,
  card_id INTEGER REFERENCES cards(id),
  transaction_date DATE NOT NULL,
  merchant_name VARCHAR(255) NOT NULL,
  merchant_code VARCHAR(50),
  industry_type VARCHAR(100),
  amount DECIMAL(12, 2) NOT NULL,
  usage_description TEXT,
  additional_notes TEXT,              -- v3.1 ì¶”ê°€
  tax_category VARCHAR(50),            -- v3.1 ì¶”ê°€
  status VARCHAR(20) DEFAULT 'pending',
  matched_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_transactions_session_id ON transactions(session_id);
CREATE INDEX idx_transactions_card_id ON transactions(card_id);
CREATE INDEX idx_transactions_status ON transactions(status);
CREATE INDEX idx_transactions_date ON transactions(transaction_date);
```

| ì»¬ëŸ¼ | íƒ€ì… | ì„¤ëª… | ì˜ˆì‹œ |
|------|------|------|------|
| id | SERIAL | ê³ ìœ  ì‹ë³„ì | 1, 2, 3... |
| session_id | INTEGER | ì—…ë¡œë“œ ì„¸ì…˜ FK | 5 |
| card_id | INTEGER | ì¹´ë“œ FK | 1 (3987) |
| transaction_date | DATE | ê±°ë˜ì¼ì | 2025-01-15 |
| merchant_name | VARCHAR(255) | ê°€ë§¹ì ëª… | "ìŠ¤íƒ€ë²…ìŠ¤ ê°•ë‚¨ì " |
| merchant_code | VARCHAR(50) | ê°€ë§¹ì  ì½”ë“œ | "1234567890" |
| industry_type | VARCHAR(100) | ì—…ì¢… | "ìŒì‹ì " |
| amount | DECIMAL(12, 2) | ê±°ë˜ê¸ˆì•¡ | 15000.00 |
| usage_description | TEXT | ì‚¬ìš©ë‚´ì—­ | "íšŒì˜ë¹„" |
| additional_notes | TEXT | **ì¶”ê°€ë©”ëª¨** (v3.1) | "ì ì‹¬ë¹µ ë¨¹ëŠë¼ê³  í•œ ê±°" |
| tax_category | VARCHAR(50) | **ì„¸ê¸ˆë¶„ë¥˜** (v3.1) | "ì‹ë¹„" |
| status | VARCHAR(20) | ìƒíƒœ | "pending", "matched" |
| matched_at | TIMESTAMP | ë§¤ì¹­ì¼ì‹œ | 2025-01-15 15:30:00 |
| created_at | TIMESTAMP | ìƒì„±ì¼ì‹œ | 2025-01-15 10:00:00 |

**Status ê°’**:
- `pending`: ë¯¸ë§¤ì¹­ (ì‚¬ìš©ë‚´ì—­ ì…ë ¥ ëŒ€ê¸°)
- `matched`: ë§¤ì¹­ ì™„ë£Œ

#### 3.1.4 `patterns` í…Œì´ë¸”

íŒ¨í„´ ë§¤ì¹­ ê·œì¹™ì„ ì €ì¥í•©ë‹ˆë‹¤.

```sql
CREATE TABLE patterns (
  id SERIAL PRIMARY KEY,
  card_id INTEGER REFERENCES cards(id),
  merchant_pattern VARCHAR(255) NOT NULL,
  usage_description TEXT NOT NULL,
  match_type VARCHAR(20) DEFAULT 'exact',
  priority INTEGER DEFAULT 0,
  use_count INTEGER DEFAULT 0,
  last_used_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_patterns_card_id ON patterns(card_id);
CREATE INDEX idx_patterns_merchant ON patterns(merchant_pattern);
CREATE INDEX idx_patterns_priority ON patterns(priority DESC);
```

| ì»¬ëŸ¼ | íƒ€ì… | ì„¤ëª… | ì˜ˆì‹œ |
|------|------|------|------|
| id | SERIAL | ê³ ìœ  ì‹ë³„ì | 1, 2, 3... |
| card_id | INTEGER | ì¹´ë“œ FK (NULL=ì „ì²´) | 1 (3987) ë˜ëŠ” NULL |
| merchant_pattern | VARCHAR(255) | ê°€ë§¹ì  íŒ¨í„´ | "ìŠ¤íƒ€ë²…ìŠ¤", "GS25%" |
| usage_description | TEXT | ì‚¬ìš©ë‚´ì—­ | "ì»¤í”¼ êµ¬ì…" |
| match_type | VARCHAR(20) | ë§¤ì¹­ ë°©ì‹ | "exact", "contains" |
| priority | INTEGER | ìš°ì„ ìˆœìœ„ (ë†’ì„ìˆ˜ë¡ ìš°ì„ ) | 10 (ì¹´ë“œ ì „ìš©), 0 (ì¼ë°˜) |
| use_count | INTEGER | ì‚¬ìš© íšŸìˆ˜ | 42 |
| last_used_at | TIMESTAMP | ë§ˆì§€ë§‰ ì‚¬ìš©ì¼ì‹œ | 2025-01-15 10:00:00 |
| created_at | TIMESTAMP | ìƒì„±ì¼ì‹œ | 2025-01-01 10:00:00 |

**Match Type**:
- `exact`: ì •í™• ì¼ì¹˜ (merchant_name == merchant_pattern)
- `contains`: í¬í•¨ ì¼ì¹˜ (merchant_name LIKE '%pattern%')

**Priority ê·œì¹™**:
- `10`: ì¹´ë“œ ì „ìš© íŒ¨í„´ (íŠ¹ì • ì¹´ë“œì—ë§Œ ì ìš©)
- `5`: í¬í•¨ ë§¤ì¹­ íŒ¨í„´
- `0`: ì •í™• ë§¤ì¹­ íŒ¨í„´

#### 3.1.5 `sessions` í…Œì´ë¸”

íŒŒì¼ ì—…ë¡œë“œ ì„¸ì…˜ ì •ë³´ë¥¼ ì €ì¥í•©ë‹ˆë‹¤.

```sql
CREATE TABLE sessions (
  id SERIAL PRIMARY KEY,
  file_name VARCHAR(255) NOT NULL,
  uploaded_at TIMESTAMP DEFAULT NOW(),
  total_count INTEGER DEFAULT 0,
  matched_count INTEGER DEFAULT 0,
  pending_count INTEGER DEFAULT 0
);
```

| ì»¬ëŸ¼ | íƒ€ì… | ì„¤ëª… | ì˜ˆì‹œ |
|------|------|------|------|
| id | SERIAL | ê³ ìœ  ì‹ë³„ì | 1, 2, 3... |
| file_name | VARCHAR(255) | ì—…ë¡œë“œ íŒŒì¼ëª… | "ì¹´ë“œ_202501.xlsx" |
| uploaded_at | TIMESTAMP | ì—…ë¡œë“œì¼ì‹œ | 2025-01-15 10:00:00 |
| total_count | INTEGER | ì´ ê±°ë˜ ê±´ìˆ˜ | 150 |
| matched_count | INTEGER | ë§¤ì¹­ ì™„ë£Œ ê±´ìˆ˜ | 120 |
| pending_count | INTEGER | ë¯¸ë§¤ì¹­ ê±´ìˆ˜ | 30 |

### 3.2 ë°ì´í„°ë² ì´ìŠ¤ ê´€ê³„ë„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  users  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”¤  cards  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”¤ transactions â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚                      â”‚
                         â”‚                      â”‚
                         â–¼                      â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ patterns â”‚         â”‚ sessions â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ê´€ê³„ ì„¤ëª…**:
1. `users` â†” `cards`: 1:N (í•œ ì‚¬ìš©ìëŠ” ì—¬ëŸ¬ ì¹´ë“œ ì†Œìœ  ê°€ëŠ¥)
2. `cards` â†” `transactions`: 1:N (í•œ ì¹´ë“œëŠ” ì—¬ëŸ¬ ê±°ë˜ ë³´ìœ )
3. `cards` â†” `patterns`: 1:N (ì¹´ë“œë³„ ì „ìš© íŒ¨í„´ ê°€ëŠ¥, NULLì´ë©´ ì „ì²´ ì ìš©)
4. `sessions` â†” `transactions`: 1:N (í•œ ì—…ë¡œë“œ ì„¸ì…˜ì— ì—¬ëŸ¬ ê±°ë˜)

---

## 4. í”„ë¡œì íŠ¸ êµ¬ì¡° ìƒì„¸

### 4.1 ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                          # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ layout.tsx                # ë£¨íŠ¸ ë ˆì´ì•„ì›ƒ (Sidebar + ChatSidebar)
â”‚   â”‚   â”œâ”€â”€ page.tsx                  # ëŒ€ì‹œë³´ë“œ (/)
â”‚   â”‚   â”œâ”€â”€ globals.css               # ì „ì—­ ìŠ¤íƒ€ì¼
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ transactions/             # ê±°ë˜ ê´€ë¦¬ (/transactions)
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx              # ê±°ë˜ ëª©ë¡ + ë§¤ì¹­ ëª¨ë‹¬
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ upload/                   # íŒŒì¼ ì—…ë¡œë“œ (/upload)
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx              # ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì—…ë¡œë“œ
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ export/                   # ì—‘ì…€ ë‚´ë³´ë‚´ê¸° (/export)
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx              # ê¸°ê°„ë³„ ë‹¤ìš´ë¡œë“œ
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ cards/                    # ì¹´ë“œ ê´€ë¦¬ (/cards)
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx              # ì¹´ë“œ ëª©ë¡
â”‚   â”‚   â”‚   â””â”€â”€ [cardId]/
â”‚   â”‚   â”‚       â””â”€â”€ page.tsx          # ì¹´ë“œ ìƒì„¸
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ users/                    # ì‚¬ìš©ì ê´€ë¦¬ (/users)
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx              # ì‚¬ìš©ì ëª©ë¡
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ patterns/                 # íŒ¨í„´ ê´€ë¦¬ (/patterns)
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx              # íŒ¨í„´ ëª©ë¡ + CRUD
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ analytics/                # ë¶„ì„ (/analytics)
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx              # ì°¨íŠ¸ ë° í†µê³„
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ assistant/                # AI ì–´ì‹œìŠ¤í„´íŠ¸ ì „ìš© í˜ì´ì§€ (/assistant)
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx              # ì „ì²´ í™”ë©´ ì±„íŒ…
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ api/                      # API Routes
â”‚   â”‚       â””â”€â”€ assistant/            # AI ì–´ì‹œìŠ¤í„´íŠ¸ API
â”‚   â”‚           â””â”€â”€ route.ts          # POST /api/assistant (ìŠ¤íŠ¸ë¦¬ë°)
â”‚   â”‚
â”‚   â”œâ”€â”€ components/                   # React ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ layout/                   # ë ˆì´ì•„ì›ƒ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ Sidebar.tsx           # ì¢Œì¸¡ ì‚¬ì´ë“œë°” (ë„¤ë¹„ê²Œì´ì…˜)
â”‚   â”‚   â”‚   â””â”€â”€ Header.tsx            # (ì‚¬ìš© ì•ˆ í•¨)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ chat-sidebar/             # ìš°ì¸¡ AI ì±„íŒ… ì‚¬ì´ë“œë°”
â”‚   â”‚   â”‚   â”œâ”€â”€ ChatSidebar.tsx       # ê³ ì • ì‚¬ì´ë“œë°” (800px)
â”‚   â”‚   â”‚   â”œâ”€â”€ ChatSidebarHeader.tsx # í—¤ë” (ìµœì†Œí™”, ì´ˆê¸°í™”)
â”‚   â”‚   â”‚   â””â”€â”€ AISettingsModal.tsx   # AI ì„¤ì • ëª¨ë‹¬
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ transactions/             # ê±°ë˜ ê´€ë ¨ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ TransactionTable.tsx  # ê±°ë˜ í…Œì´ë¸”
â”‚   â”‚   â”‚   â”œâ”€â”€ MatchModal.tsx        # ë‹¨ì¼ ë§¤ì¹­ ëª¨ë‹¬
â”‚   â”‚   â”‚   â””â”€â”€ BatchMatchModal.tsx   # ì¼ê´„ ë§¤ì¹­ ëª¨ë‹¬
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ dashboard/                # ëŒ€ì‹œë³´ë“œ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ StatsCard.tsx         # í†µê³„ ì¹´ë“œ
â”‚   â”‚   â”‚   â””â”€â”€ RecentActivity.tsx    # ìµœê·¼ í™œë™
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ assistant/                # AI ê´€ë ¨ UI
â”‚   â”‚   â”‚   â””â”€â”€ AssistantMessage.tsx  # ë©”ì‹œì§€ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ ui/                       # ê³µí†µ UI ì»´í¬ë„ŒíŠ¸
â”‚   â”‚       â”œâ”€â”€ Button.tsx            # ë²„íŠ¼
â”‚   â”‚       â”œâ”€â”€ Modal.tsx             # ëª¨ë‹¬
â”‚   â”‚       â”œâ”€â”€ Badge.tsx             # ë±ƒì§€
â”‚   â”‚       â”œâ”€â”€ Table.tsx             # í…Œì´ë¸”
â”‚   â”‚       â”œâ”€â”€ Tabs.tsx              # íƒ­
â”‚   â”‚       â”œâ”€â”€ ThemeToggle.tsx       # ë‹¤í¬ëª¨ë“œ í† ê¸€
â”‚   â”‚       â””â”€â”€ Autocomplete.tsx      # ìë™ì™„ì„± ì…ë ¥
â”‚   â”‚
â”‚   â”œâ”€â”€ lib/                          # ìœ í‹¸ë¦¬í‹° ë° ì„¤ì •
â”‚   â”‚   â”œâ”€â”€ supabase/                 # Supabase í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ client.ts             # ë¸Œë¼ìš°ì € í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”‚   â””â”€â”€ server.ts             # ì„œë²„ í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ai/                       # AI ê´€ë ¨
â”‚   â”‚   â”‚   â”œâ”€â”€ openrouter-config.ts  # AI í”„ë¡œë°”ì´ë” ì„¤ì •
â”‚   â”‚   â”‚   â””â”€â”€ settings-store.ts     # ì„¤ì • ì €ì¥ì†Œ (LocalStorage)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ api.ts                    # API í´ë¼ì´ì–¸íŠ¸ (Supabase RPC)
â”‚   â”‚   â”œâ”€â”€ excel.ts                  # ì—‘ì…€ íŒŒì‹± ë° ìƒì„±
â”‚   â”‚   â”œâ”€â”€ utils.ts                  # ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
â”‚   â”‚   â”œâ”€â”€ industryMapping.ts        # ì—…ì¢… ì½”ë“œ ë§¤í•‘
â”‚   â”‚   â”œâ”€â”€ taxCategories.ts          # ì„¸ê¸ˆ ë¶„ë¥˜ ì¹´í…Œê³ ë¦¬ ì •ì˜
â”‚   â”‚   â””â”€â”€ taxClassifier.ts          # ë£° ê¸°ë°˜ ì„¸ê¸ˆ ìë™ ë¶„ë¥˜
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/                        # Custom Hooks
â”‚   â”‚   â””â”€â”€ useApi.ts                 # React Query Hooks
â”‚   â”‚
â”‚   â””â”€â”€ types/                        # TypeScript íƒ€ì… ì •ì˜
â”‚       â””â”€â”€ index.ts                  # ì „ì—­ íƒ€ì…
â”‚
â”œâ”€â”€ .env.local                        # í™˜ê²½ë³€ìˆ˜ (ë¡œì»¬)
â”œâ”€â”€ .env.example                      # í™˜ê²½ë³€ìˆ˜ ì˜ˆì‹œ
â”œâ”€â”€ next.config.ts                    # Next.js ì„¤ì •
â”œâ”€â”€ tailwind.config.ts                # Tailwind CSS ì„¤ì •
â”œâ”€â”€ tsconfig.json                     # TypeScript ì„¤ì •
â””â”€â”€ package.json                      # ì˜ì¡´ì„± ë° ìŠ¤í¬ë¦½íŠ¸
```

### 4.2 í•µì‹¬ íŒŒì¼ ìƒì„¸ ì„¤ëª…

#### 4.2.1 `app/layout.tsx` - ë£¨íŠ¸ ë ˆì´ì•„ì›ƒ

ì „ì²´ ì•±ì˜ ë ˆì´ì•„ì›ƒì„ ì •ì˜í•©ë‹ˆë‹¤. Sidebar(ì¢Œì¸¡)ì™€ ChatSidebar(ìš°ì¸¡)ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.

```tsx
export default function RootLayout({ children }) {
  return (
    <html lang="ko">
      <body>
        <QueryClientProvider>
          <div className="flex h-screen overflow-hidden">
            {/* ì¢Œì¸¡ ì‚¬ì´ë“œë°” */}
            <Sidebar />

            {/* ë©”ì¸ ì»¨í…ì¸  */}
            <main className="flex-1 overflow-auto">
              {children}
            </main>

            {/* ìš°ì¸¡ AI ì±„íŒ… ì‚¬ì´ë“œë°” (ê³ ì •) */}
            <ChatSidebar />
          </div>
        </QueryClientProvider>
      </body>
    </html>
  );
}
```

**ì£¼ìš” íŠ¹ì§•**:
- `flex` ë ˆì´ì•„ì›ƒìœ¼ë¡œ Sidebar + Main + ChatSidebar ë°°ì¹˜
- ChatSidebarëŠ” í•­ìƒ ë³´ì´ëŠ” ê³ ì •í˜• (800px)
- QueryClientProviderë¡œ React Query ê¸€ë¡œë²Œ ì„¤ì •

#### 4.2.2 `app/transactions/page.tsx` - ê±°ë˜ ê´€ë¦¬ í˜ì´ì§€

**v3.1.1ì—ì„œ /workspaceì™€ í†µí•©ë¨. ì´ì œ ë‹¨ë… í˜ì´ì§€ë¡œ ì‚¬ìš©.**

```tsx
'use client';

export default function TransactionsPage() {
  // ìƒíƒœ ê´€ë¦¬
  const [selectedTransaction, setSelectedTransaction] = useState<Transaction | null>(null);
  const [usageDescription, setUsageDescription] = useState('');
  const [additionalNotes, setAdditionalNotes] = useState('');  // v3.1 ì¶”ê°€
  const [taxCategory, setTaxCategory] = useState('');          // v3.1 ì¶”ê°€

  // React Query Hooks
  const { data: transactions } = useTransactions();
  const matchTransaction = useMatchTransaction();

  // ë§¤ì¹­ ì²˜ë¦¬
  const handleMatch = () => {
    matchTransaction.mutate({
      id: selectedTransaction.id,
      usageDescription,
      additionalNotes: additionalNotes || undefined,
      taxCategory: taxCategory || undefined,
    });
  };

  // ìë™ ë¶„ë¥˜ ë²„íŠ¼
  const handleAutoClassify = () => {
    const classified = classifyTransaction(
      selectedTransaction.merchant_name,
      usageDescription || null,
      selectedTransaction.amount
    );
    setTaxCategory(classified);
  };

  return (
    <div>
      {/* í…Œì´ë¸”: 10ê°œ ì»¬ëŸ¼ */}
      <Table>
        <TableHead>ê±°ë˜ì¼</TableHead>
        <TableHead>ì¹´ë“œ</TableHead>
        <TableHead>ê°€ë§¹ì </TableHead>
        <TableHead>ì—…ì¢…</TableHead>
        <TableHead>ê¸ˆì•¡</TableHead>
        <TableHead>ì‚¬ìš©ë‚´ì—­</TableHead>
        <TableHead>ì¶”ê°€ë©”ëª¨</TableHead>      {/* v3.1 ì¶”ê°€ */}
        <TableHead>ì„¸ê¸ˆë¶„ë¥˜</TableHead>       {/* v3.1 ì¶”ê°€ */}
        <TableHead>ìƒíƒœ</TableHead>
        <TableHead>ì•¡ì…˜</TableHead>
      </Table>

      {/* ë§¤ì¹­ ëª¨ë‹¬ */}
      <MatchModal
        transaction={selectedTransaction}
        usageDescription={usageDescription}
        additionalNotes={additionalNotes}
        taxCategory={taxCategory}
        onSubmit={handleMatch}
      />
    </div>
  );
}
```

**í•µì‹¬ ê¸°ëŠ¥**:
1. **ê±°ë˜ ëª©ë¡ í‘œì‹œ**: 10ê°œ ì»¬ëŸ¼ (ì¶”ê°€ë©”ëª¨, ì„¸ê¸ˆë¶„ë¥˜ í¬í•¨)
2. **ë‹¨ì¼ ë§¤ì¹­ ëª¨ë‹¬**: ê°œë³„ ê±°ë˜ ìˆ˜ë™ ë§¤ì¹­
3. **ì¼ê´„ ë§¤ì¹­ ëª¨ë‹¬**: ì„ íƒëœ ì—¬ëŸ¬ ê±°ë˜ë¥¼ í•œ ë²ˆì— ë§¤ì¹­
4. **ìë™ ë¶„ë¥˜ ë²„íŠ¼**: ë£° ê¸°ë°˜ ì„¸ê¸ˆ ì¹´í…Œê³ ë¦¬ ìë™ ì§€ì •
5. **í•„í„°ë§**: ì¹´ë“œë³„, ìƒíƒœë³„ í•„í„°

#### 4.2.3 `components/chat-sidebar/ChatSidebar.tsx` - AI ì±„íŒ… ì‚¬ì´ë“œë°”

```tsx
'use client';

export function ChatSidebar() {
  const [messages, setMessages] = useState<Message[]>([]);
  const [input, setInput] = useState('');
  const [isMinimized, setIsMinimized] = useState(false);

  const { append, isLoading } = useChat({
    api: '/api/assistant',
    onFinish: (message) => {
      setMessages((prev) => [...prev, message]);
    },
  });

  const handleSubmit = async (e) => {
    e.preventDefault();
    await append({ role: 'user', content: input });
    setInput('');
  };

  return (
    <aside className={`bg-gray-50 border-l ${isMinimized ? 'w-0' : 'w-[800px]'}`}>
      <ChatSidebarHeader
        onMinimize={() => setIsMinimized(!isMinimized)}
        onReset={() => setMessages([])}
      />

      {/* ë©”ì‹œì§€ ëª©ë¡ */}
      <div className="flex-1 overflow-y-auto">
        {messages.map((msg) => (
          <AssistantMessage key={msg.id} message={msg} />
        ))}
      </div>

      {/* ì…ë ¥ í¼ */}
      <form onSubmit={handleSubmit}>
        <input
          value={input}
          onChange={(e) => setInput(e.target.value)}
          placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..."
        />
        <button type="submit" disabled={isLoading}>
          ì „ì†¡
        </button>
      </form>
    </aside>
  );
}
```

**í•µì‹¬ ê¸°ëŠ¥**:
1. **ê³ ì •í˜• ì‚¬ì´ë“œë°”**: 800px ê³ ì • ë„ˆë¹„, í•­ìƒ í‘œì‹œ
2. **ìµœì†Œí™” ê¸°ëŠ¥**: ë²„íŠ¼ìœ¼ë¡œ ìˆ¨ê¸°ê¸°/ë³´ì´ê¸°
3. **ìŠ¤íŠ¸ë¦¬ë° ì±„íŒ…**: Vercel AI SDKì˜ `useChat` ì‚¬ìš©
4. **ëŒ€í™” ì´ˆê¸°í™”**: ëŒ€í™” ë‚´ì—­ ì‚­ì œ
5. **AI ì„¤ì •**: í”„ë¡œë°”ì´ë”, ëª¨ë¸, API í‚¤ ì„¤ì •

#### 4.2.4 `app/api/assistant/route.ts` - AI ì–´ì‹œìŠ¤í„´íŠ¸ API

```tsx
import { streamText } from 'ai';
import { createOpenRouter } from '@openrouter/ai-sdk-provider';

export async function POST(req: Request) {
  const { messages, provider, model, apiKey } = await req.json();

  // AI í”„ë¡œë°”ì´ë” ì´ˆê¸°í™”
  const openrouter = createOpenRouter({ apiKey });

  // ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ
  const result = streamText({
    model: openrouter(model),
    messages,
    system: `ë‹¹ì‹ ì€ ì¹ ì¹ ê¸°ì—… ë²•ì¸ì¹´ë“œ ê´€ë¦¬ ì‹œìŠ¤í…œì˜ AI ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤.

    ì£¼ìš” ê¸°ëŠ¥:
    - ê±°ë˜ ë‚´ì—­ ì¡°íšŒ
    - íŒ¨í„´ ë§¤ì¹­ ì§€ì›
    - ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ìš”ì²­
    - ë¶„ì„ ë¦¬í¬íŠ¸ ìƒì„±

    ë°ì´í„°ë² ì´ìŠ¤ ì •ë³´:
    - users: ì‚¬ìš©ì ì •ë³´
    - cards: ë²•ì¸ì¹´ë“œ ì •ë³´
    - transactions: ê±°ë˜ ë‚´ì—­ (ì¶”ê°€ë©”ëª¨, ì„¸ê¸ˆë¶„ë¥˜ í¬í•¨)
    - patterns: íŒ¨í„´ ë§¤ì¹­ ê·œì¹™

    í•­ìƒ ì¹œì ˆí•˜ê³  ì •í™•í•˜ê²Œ ë‹µë³€í•˜ì„¸ìš”.`,
  });

  return result.toDataStreamResponse();
}
```

**í•µì‹¬ ê¸°ëŠ¥**:
1. **ë©€í‹° í”„ë¡œë°”ì´ë” ì§€ì›**: DeepSeek, OpenAI, Anthropic, OpenRouter
2. **ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ**: ì‹¤ì‹œê°„ìœ¼ë¡œ ë‹µë³€ ìŠ¤íŠ¸ë¦¬ë°
3. **ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸**: ì—­í• , ê¸°ëŠ¥, ë°ì´í„° êµ¬ì¡° í¬í•¨
4. **API í‚¤ ê´€ë¦¬**: ì„œë²„ ì„¤ì • ë˜ëŠ” í´ë¼ì´ì–¸íŠ¸ ì…ë ¥

#### 4.2.5 `lib/excel.ts` - ì—‘ì…€ ì²˜ë¦¬

**v3.1ì—ì„œ 6ì»¬ëŸ¼ ë‚´ë³´ë‚´ê¸° ì¶”ê°€.**

```tsx
import ExcelJS from 'exceljs';

// ì—‘ì…€ ì—…ë¡œë“œ íŒŒì‹±
export async function parseExcelFile(file: File): Promise<Transaction[]> {
  const workbook = new ExcelJS.Workbook();
  await workbook.xlsx.load(await file.arrayBuffer());

  const transactions: Transaction[] = [];

  // ê° ì‹œíŠ¸ ì²˜ë¦¬
  workbook.eachSheet((sheet) => {
    const cardNumber = extractCardNumber(sheet.name);

    sheet.eachRow((row, rowNumber) => {
      if (rowNumber <= 5) return; // í—¤ë” ìŠ¤í‚µ

      const transaction = {
        card_number: cardNumber,
        transaction_date: parseDate(row.getCell(1).value),
        merchant_name: row.getCell(3).value as string,
        amount: parseFloat(row.getCell(4).value as string),
        industry_type: row.getCell(5).value as string,
      };

      transactions.push(transaction);
    });
  });

  return transactions;
}

// ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ìƒì„± (v3.1: 6ì»¬ëŸ¼)
export async function generateExcelFile(
  transactions: Transaction[],
  startDate: Date,
  endDate: Date
): Promise<Buffer> {
  const workbook = new ExcelJS.Workbook();
  const worksheet = workbook.addWorksheet('ê±°ë˜ë‚´ì—­');

  // ì»¬ëŸ¼ ì •ì˜ (v3.1: 6ì»¬ëŸ¼)
  worksheet.columns = [
    { header: 'ê²°ì œì¼ì', key: 'date', width: 12 },
    { header: 'ê°€ë§¹ì ëª…', key: 'merchant', width: 30 },
    { header: 'ì´ìš©ê¸ˆì•¡', key: 'amount', width: 15 },
    { header: 'ì‚¬ìš©ìš©ë„', key: 'usage', width: 30 },
    { header: 'ì¶”ê°€ë©”ëª¨', key: 'notes', width: 40 },  // v3.1 ì¶”ê°€
    { header: 'ì„¸ê¸ˆë¶„ë¥˜', key: 'tax', width: 20 },    // v3.1 ì¶”ê°€
  ];

  // ë°ì´í„° ì¶”ê°€
  transactions.forEach((tx) => {
    worksheet.addRow({
      date: new Date(tx.transaction_date),
      merchant: tx.merchant_name,
      amount: tx.amount,
      usage: tx.usage_description || '',
      notes: tx.additional_notes || '',  // v3.1 ì¶”ê°€
      tax: tx.tax_category || '',        // v3.1 ì¶”ê°€
    });
  });

  // ìŠ¤íƒ€ì¼ ì ìš©
  worksheet.getRow(1).font = { bold: true };
  worksheet.getRow(1).fill = {
    type: 'pattern',
    pattern: 'solid',
    fgColor: { argb: 'FF4472C4' },
  };

  return await workbook.xlsx.writeBuffer();
}
```

**í•µì‹¬ ê¸°ëŠ¥**:
1. **ì—‘ì…€ íŒŒì‹±**: XLSX/XLS íŒŒì¼ ì½ê¸°, ê° ì‹œíŠ¸ë³„ ê±°ë˜ ì¶”ì¶œ
2. **ì¹´ë“œ ë²ˆí˜¸ ì¶”ì¶œ**: ì‹œíŠ¸ëª…ì—ì„œ 4ìë¦¬ ì¹´ë“œ ë²ˆí˜¸ íŒŒì‹±
3. **ì—‘ì…€ ìƒì„±**: 6ì»¬ëŸ¼ (ê²°ì œì¼ì, ê°€ë§¹ì ëª…, ì´ìš©ê¸ˆì•¡, ì‚¬ìš©ìš©ë„, ì¶”ê°€ë©”ëª¨, ì„¸ê¸ˆë¶„ë¥˜)
4. **ìŠ¤íƒ€ì¼ ì ìš©**: í—¤ë” ë³¼ë“œ, ë°°ê²½ìƒ‰

#### 4.2.6 `lib/taxClassifier.ts` - ì„¸ê¸ˆ ë¶„ë¥˜ ì—”ì§„

**v3.1ì—ì„œ ì¶”ê°€ëœ ë£° ê¸°ë°˜ ìë™ ë¶„ë¥˜ ì‹œìŠ¤í…œ.**

```tsx
import type { TaxCategory } from './taxCategories';

// ë¶„ë¥˜ ê·œì¹™ ì •ì˜
const CLASSIFICATION_RULES: Record<TaxCategory, ClassificationRule> = {
  'ì ‘ëŒ€ë¹„': {
    merchant: ['í˜¸í…”', 'ë¦¬ì¡°íŠ¸', 'ê³¨í”„', 'ê³ ê¸‰', 'í”„ë¦¬ë¯¸ì—„'],
    usage: ['ì ‘ëŒ€', 'ê±°ë˜ì²˜', 'ê³ ê°', 'íšŒì‹'],
    amountRange: { min: 50000 },
  },
  'ì—…ë¬´ì¶”ì§„ë¹„': {
    merchant: ['íšŒì˜ì‹¤', 'ë¯¸íŒ…ë£¸'],
    usage: ['íšŒì˜', 'ë¯¸íŒ…', 'ì—…ë¬´', 'í˜‘ì˜'],
  },
  'ë³µë¦¬í›„ìƒë¹„': {
    merchant: ['í—¬ìŠ¤', 'í”¼íŠ¸ë‹ˆìŠ¤', 'ë§ˆì‚¬ì§€', 'ë³‘ì›', 'ì•½êµ­'],
    usage: ['ê±´ê°•ê²€ì§„', 'ë³µì§€', 'ì§ì›'],
  },
  'ì‹ë¹„': {
    merchant: ['ì‹ë‹¹', 'ìŒì‹', 'ì¹´í˜', 'ìŠ¤íƒ€ë²…ìŠ¤', 'ë§¥ë„ë‚ ë“œ', 'í¸ì˜ì '],
    usage: ['ì‹ì‚¬', 'ì ì‹¬', 'ì €ë…', 'ì»¤í”¼', 'ê°„ì‹'],
  },
  'êµí†µë¹„': {
    merchant: ['íƒì‹œ', 'ë²„ìŠ¤', 'ì§€í•˜ì² ', 'ê¸°ì°¨', 'ktx'],
    usage: ['êµí†µ', 'íƒì‹œ', 'ì¶œì¥', 'ì´ë™'],
  },
  'ì°¨ëŸ‰ìœ ë¥˜ë¹„': {
    merchant: ['ì£¼ìœ ', 'gsì¹¼í…ìŠ¤', 's-oil', 'skì—ë„ˆì§€'],
    usage: ['ì£¼ìœ ', 'ê²½ìœ ', 'íœ˜ë°œìœ ', 'ìœ ë¥˜'],
  },
  'í†µì‹ ë¹„': {
    merchant: ['skt', 'kt', 'lgìœ í”ŒëŸ¬ìŠ¤', 'í†µì‹ '],
    usage: ['í†µì‹ ', 'ì¸í„°ë„·', 'ì „í™”'],
  },
  'íšŒì˜ë¹„': {
    merchant: ['íšŒì˜ì‹¤', 'ì„¸ë¯¸ë‚˜'],
    usage: ['íšŒì˜', 'ì„¸ë¯¸ë‚˜', 'ì›Œí¬ìƒµ'],
  },
  'ì†Œëª¨í’ˆë¹„': {
    merchant: ['ë¬¸êµ¬', 'ì‚¬ë¬´', 'ìš©í’ˆ', 'ë‹¤ì´ì†Œ'],
    usage: ['ì†Œëª¨í’ˆ', 'ì‚¬ë¬´ìš©í’ˆ', 'ë¹„í’ˆ'],
  },
  'êµìœ¡í›ˆë ¨ë¹„': {
    merchant: ['êµìœ¡', 'í•™ì›', 'ê°•ì˜'],
    usage: ['êµìœ¡', 'ì—°ìˆ˜', 'ê°•ì˜', 'ì„¸ë¯¸ë‚˜'],
  },
  'ê¸°íƒ€': {
    merchant: [],
    usage: [],
  },
};

// ë¶„ë¥˜ í•¨ìˆ˜
export function classifyTransaction(
  merchantName: string,
  usageDescription: string | null,
  amount: number
): TaxCategory {
  const merchant = merchantName.toLowerCase().trim();
  const usage = (usageDescription || '').toLowerCase().trim();

  // 1ìˆœìœ„: ì‚¬ìš©ìš©ë„ í‚¤ì›Œë“œ ë§¤ì¹­
  if (usage) {
    for (const [category, rules] of Object.entries(CLASSIFICATION_RULES)) {
      if (rules.usage.some(keyword => usage.includes(keyword))) {
        return category as TaxCategory;
      }
    }
  }

  // 2ìˆœìœ„: ê°€ë§¹ì ëª… í‚¤ì›Œë“œ ë§¤ì¹­
  for (const [category, rules] of Object.entries(CLASSIFICATION_RULES)) {
    if (rules.merchant.some(keyword => merchant.includes(keyword))) {
      return category as TaxCategory;
    }
  }

  // 3ìˆœìœ„: ê¸ˆì•¡ ê¸°ë°˜ ì¶”ë¡ 
  if (amount >= 1000000) return 'ì ‘ëŒ€ë¹„';
  if (amount <= 10000 && merchant.includes('í¸ì˜ì ')) return 'ì†Œëª¨í’ˆë¹„';

  // ê¸°ë³¸ê°’
  return 'ê¸°íƒ€';
}
```

**í•µì‹¬ ë¡œì§**:
1. **1ìˆœìœ„**: ì‚¬ìš©ìš©ë„(usage_description) í‚¤ì›Œë“œ ë§¤ì¹­
2. **2ìˆœìœ„**: ê°€ë§¹ì ëª…(merchant_name) í‚¤ì›Œë“œ ë§¤ì¹­
3. **3ìˆœìœ„**: ê¸ˆì•¡(amount) ê¸°ë°˜ ì¶”ë¡ 
4. **ê¸°ë³¸ê°’**: ë§¤ì¹­ ì‹¤íŒ¨ ì‹œ 'ê¸°íƒ€'

**ë¶„ë¥˜ ì¹´í…Œê³ ë¦¬ (11ê°œ)**:
- ì ‘ëŒ€ë¹„
- ì—…ë¬´ì¶”ì§„ë¹„
- ë³µë¦¬í›„ìƒë¹„
- ì†Œëª¨í’ˆë¹„
- ì°¨ëŸ‰ìœ ë¥˜ë¹„
- êµí†µë¹„
- í†µì‹ ë¹„
- ì‹ë¹„
- íšŒì˜ë¹„
- êµìœ¡í›ˆë ¨ë¹„
- ê¸°íƒ€

---

## 5. í•µì‹¬ ê¸°ëŠ¥ ìƒì„¸

### 5.1 íŒŒì¼ ì—…ë¡œë“œ ë° íŒŒì‹±

#### 5.1.1 ì›Œí¬í”Œë¡œìš°

```
ì‚¬ìš©ìê°€ XLSX íŒŒì¼ ì—…ë¡œë“œ
   â†“
ë“œë˜ê·¸ ì•¤ ë“œë¡­ ë˜ëŠ” íŒŒì¼ ì„ íƒ
   â†“
ExcelJSë¡œ íŒŒì¼ íŒŒì‹±
   â†“
ê° ì‹œíŠ¸ë¥¼ ìˆœíšŒí•˜ë©° ê±°ë˜ ì¶”ì¶œ
   â†“
ì¹´ë“œ ë²ˆí˜¸ ì¶”ì¶œ (ì‹œíŠ¸ëª…ì—ì„œ)
   â†“
Supabaseì— ì¼ê´„ ì €ì¥
   â†“
Session ìƒì„± (íŒŒì¼ëª…, ì´ ê±´ìˆ˜ ê¸°ë¡)
   â†“
ìë™ íŒ¨í„´ ë§¤ì¹­ ì‹¤í–‰ (4ë‹¨ê³„)
   â†“
ëŒ€ì‹œë³´ë“œë¡œ ì´ë™ (ë§¤ì¹­ ê²°ê³¼ í‘œì‹œ)
```

#### 5.1.2 íŒŒì¼ êµ¬ì¡° ì˜ˆì‹œ

```
ì¹´ë“œ_202501.xlsx
â”œâ”€â”€ ê¹€ì¤€êµ (ì‹œíŠ¸ëª… â†’ ì¹´ë“œë²ˆí˜¸ 3987 ë§¤í•‘)
â”‚   â”œâ”€â”€ Row 1-5: í—¤ë” (ìŠ¤í‚µ)
â”‚   â”œâ”€â”€ Row 6: 2025-01-01 | ìŠ¤íƒ€ë²…ìŠ¤ ê°•ë‚¨ì  | 5,500 | ìŒì‹ì 
â”‚   â”œâ”€â”€ Row 7: 2025-01-02 | GS25 | 12,000 | í¸ì˜ì 
â”‚   â””â”€â”€ ...
â”œâ”€â”€ ê¹€ìš©ì„ (ì‹œíŠ¸ëª… â†’ ì¹´ë“œë²ˆí˜¸ 4985 ë§¤í•‘)
â””â”€â”€ í•˜ì´íŒ¨ìŠ¤ (ì‹œíŠ¸ëª… â†’ ì¹´ë“œë²ˆí˜¸ 6902 ë§¤í•‘)
```

#### 5.1.3 ì¹´ë“œ ë²ˆí˜¸ ì¶”ì¶œ ë¡œì§

```tsx
function extractCardNumber(sheetName: string): string {
  // ë§¤í•‘ í…Œì´ë¸”
  const SHEET_TO_CARD: Record<string, string> = {
    'ê¹€ì¤€êµ': '3987',
    'ê¹€ìš©ì„': '4985',
    'ë…¸í˜œê²½': '6974',
    'í•˜ì´íŒ¨ìŠ¤': '6902',
    'ê³µìš©': '9980',
    '0981': '0981',
    '9904': '9904',
  };

  // ì‹œíŠ¸ëª…ì—ì„œ ë§¤í•‘
  for (const [key, cardNumber] of Object.entries(SHEET_TO_CARD)) {
    if (sheetName.includes(key)) {
      return cardNumber;
    }
  }

  // 4ìë¦¬ ìˆ«ì ì¶”ì¶œ
  const match = sheetName.match(/\d{4}/);
  if (match) return match[0];

  // ê¸°ë³¸ê°’
  return '9980'; // ê³µìš©ì¹´ë“œ
}
```

### 5.2 ê±°ë˜ ë§¤ì¹­ ì‹œìŠ¤í…œ

#### 5.2.1 ë§¤ì¹­ ëª¨ë“œ

1. **ë‹¨ì¼ ë§¤ì¹­ (Single Match)**
   - ê±°ë˜ 1ê±´ì„ ê°œë³„ì ìœ¼ë¡œ ë§¤ì¹­
   - ëª¨ë‹¬ UIë¡œ ì‚¬ìš©ë‚´ì—­, ì¶”ê°€ë©”ëª¨, ì„¸ê¸ˆë¶„ë¥˜ ì…ë ¥
   - ìë™ ë¶„ë¥˜ ë²„íŠ¼ìœ¼ë¡œ ì„¸ê¸ˆ ì¹´í…Œê³ ë¦¬ ì œì•ˆ

2. **ì¼ê´„ ë§¤ì¹­ (Batch Match)**
   - ì„ íƒëœ ì—¬ëŸ¬ ê±°ë˜ë¥¼ í•œ ë²ˆì— ë§¤ì¹­
   - ëª¨ë“  ê±°ë˜ì— ë™ì¼í•œ ì‚¬ìš©ë‚´ì—­ ì ìš©
   - ì¶”ê°€ë©”ëª¨, ì„¸ê¸ˆë¶„ë¥˜ëŠ” ì„ íƒ ì…ë ¥
   - ì§„í–‰ë¥  í‘œì‹œ (í”„ë¡œê·¸ë ˆìŠ¤ ë°”)

#### 5.2.2 ë‹¨ì¼ ë§¤ì¹­ íë¦„

```
ì‚¬ìš©ìê°€ 'ë§¤ì¹­' ë²„íŠ¼ í´ë¦­
   â†“
MatchModal ì—´ë¦¼
   â†“
Autocompleteë¡œ ì‚¬ìš©ë‚´ì—­ ì…ë ¥
   - ìì£¼ ì‚¬ìš©: USAGE_CATEGORIES
   - íŒ¨í„´: ê¸°ì¡´ patterns ëª©ë¡
   â†“
ì¶”ê°€ë©”ëª¨ ì…ë ¥ (ì„ íƒ)
   - ì˜ˆ: "ì ì‹¬ë¹µ ë¨¹ëŠë¼ê³  í•œ ê±°"
   â†“
ì„¸ê¸ˆë¶„ë¥˜ ì„ íƒ ë˜ëŠ” ìë™ ë¶„ë¥˜
   - ìë™ ë¶„ë¥˜ ë²„íŠ¼ â†’ classifyTransaction() í˜¸ì¶œ
   - ìˆ˜ë™ ì„ íƒ â†’ 11ê°œ ì¹´í…Œê³ ë¦¬ ë“œë¡­ë‹¤ìš´
   â†“
'ì €ì¥' ë²„íŠ¼ í´ë¦­
   â†“
useMatchTransaction.mutate() í˜¸ì¶œ
   â†“
Supabase RPC: match_transaction()
   - status: 'matched'
   - usage_description ì—…ë°ì´íŠ¸
   - additional_notes ì—…ë°ì´íŠ¸
   - tax_category ì—…ë°ì´íŠ¸
   - matched_at: NOW()
   â†“
React Query ìºì‹œ ë¬´íš¨í™”
   â†“
UI ìë™ ì—…ë°ì´íŠ¸ (status: matched, ì»¬ëŸ¼ ì±„ì›Œì§)
```

#### 5.2.3 ì¼ê´„ ë§¤ì¹­ íë¦„

```
ì‚¬ìš©ìê°€ ì—¬ëŸ¬ ê±°ë˜ ì„ íƒ (ì²´í¬ë°•ìŠ¤)
   â†“
'ì¼ê´„ ë§¤ì¹­' ë²„íŠ¼ í´ë¦­
   â†“
BatchMatchModal ì—´ë¦¼
   - ì„ íƒëœ ê±°ë˜ ìš”ì•½ í‘œì‹œ
   - ê°€ë§¹ì ë³„ ê·¸ë£¹í™”
   â†“
ê³µí†µ ì‚¬ìš©ë‚´ì—­ ì…ë ¥ (í•„ìˆ˜)
   â†“
ê³µí†µ ì¶”ê°€ë©”ëª¨ ì…ë ¥ (ì„ íƒ)
   â†“
ê³µí†µ ì„¸ê¸ˆë¶„ë¥˜ ì„ íƒ (ì„ íƒ, ë¯¸ì„ íƒ ì‹œ ê° ê±°ë˜ë³„ ìë™ ë¶„ë¥˜)
   â†“
'Nê±´ ì¼ê´„ ì €ì¥' ë²„íŠ¼ í´ë¦­
   â†“
for loop: ê° ê±°ë˜ë³„ë¡œ ìˆœì°¨ ì²˜ë¦¬
   - ì„¸ê¸ˆë¶„ë¥˜ ë¯¸ì„ íƒ ì‹œ: classifyTransaction() í˜¸ì¶œ
   - matchTransaction.mutate() í˜¸ì¶œ
   - ì§„í–‰ë¥  ì—…ë°ì´íŠ¸ (progress bar)
   â†“
ì™„ë£Œ í›„ ëª¨ë‹¬ ë‹«ê¸°
   â†“
React Query ìºì‹œ ë¬´íš¨í™”
   â†“
UI ìë™ ì—…ë°ì´íŠ¸
```

### 5.3 ì—‘ì…€ ë‚´ë³´ë‚´ê¸°

#### 5.3.1 ë‚´ë³´ë‚´ê¸° ì›Œí¬í”Œë¡œìš°

```
/export í˜ì´ì§€ ì ‘ì†
   â†“
ê¸°ê°„ ì„ íƒ (ì›”ë³„ ë²„íŠ¼ ë˜ëŠ” ì§ì ‘ ì…ë ¥)
   - ì´ë²ˆ ë‹¬
   - ì§€ë‚œ ë‹¬
   - ì§ì ‘ ì„ íƒ (ë‚ ì§œ ë²”ìœ„)
   â†“
'ë‹¤ìš´ë¡œë“œ' ë²„íŠ¼ í´ë¦­
   â†“
Supabaseì—ì„œ ê±°ë˜ ì¡°íšŒ
   - WHERE transaction_date BETWEEN startDate AND endDate
   - WHERE status = 'matched'
   - ORDER BY transaction_date ASC
   â†“
generateExcelFile() í˜¸ì¶œ
   - Workbook ìƒì„±
   - 6ì»¬ëŸ¼ ì„¤ì •
   - ë°ì´í„° ì¶”ê°€
   - ìŠ¤íƒ€ì¼ ì ìš©
   â†“
Bufferë¡œ ë³€í™˜
   â†“
Blob ìƒì„± â†’ íŒŒì¼ ë‹¤ìš´ë¡œë“œ
   - íŒŒì¼ëª…: transactions_YYYYMM.xlsx
```

#### 5.3.2 ì—‘ì…€ íŒŒì¼ êµ¬ì¡° (v3.1: 6ì»¬ëŸ¼)

| ì»¬ëŸ¼ | ë°ì´í„° ì†ŒìŠ¤ | ì˜ˆì‹œ |
|------|-------------|------|
| ê²°ì œì¼ì | transaction_date | 2025-01-15 |
| ê°€ë§¹ì ëª… | merchant_name | ìŠ¤íƒ€ë²…ìŠ¤ ê°•ë‚¨ì  |
| ì´ìš©ê¸ˆì•¡ | amount | 5,500 |
| ì‚¬ìš©ìš©ë„ | usage_description | ì»¤í”¼ êµ¬ì… |
| **ì¶”ê°€ë©”ëª¨** | additional_notes | "ì ì‹¬ë¹µ ë¨¹ëŠë¼ê³  í•œ ê±°" |
| **ì„¸ê¸ˆë¶„ë¥˜** | tax_category | ì‹ë¹„ |

**ìŠ¤íƒ€ì¼**:
- í—¤ë”: ë³¼ë“œ, íŒŒë€ìƒ‰ ë°°ê²½ (#4472C4)
- ë°ì´í„°: ì¼ë°˜
- ë‚ ì§œ: ë‚ ì§œ í˜•ì‹ (YYYY-MM-DD)
- ê¸ˆì•¡: ìˆ«ì í˜•ì‹ (ì²œ ë‹¨ìœ„ êµ¬ë¶„)

---

## 6. ì»´í¬ë„ŒíŠ¸ ë¶„ì„

### 6.1 Layout ì»´í¬ë„ŒíŠ¸

#### 6.1.1 `Sidebar.tsx` - ì¢Œì¸¡ ë„¤ë¹„ê²Œì´ì…˜

**v3.1.1 ë³€ê²½ì‚¬í•­**:
- `/workspace` â†’ `/transactions`ë¡œ ë§í¬ ë³€ê²½
- 'ì—…ë¡œë“œ', 'ë‚´ë³´ë‚´ê¸°' ë©”ë‰´ í•­ëª© ì¶”ê°€

```tsx
const navigation = [
  { name: 'ëŒ€ì‹œë³´ë“œ', href: '/', icon: LayoutDashboard },
  { name: 'ê±°ë˜ê´€ë¦¬', href: '/transactions', icon: FileText },  // âœ… ë³€ê²½ë¨
  { name: 'ì—…ë¡œë“œ', href: '/upload', icon: Upload },            // âœ… ì¶”ê°€ë¨
  { name: 'ë‚´ë³´ë‚´ê¸°', href: '/export', icon: Download },        // âœ… ì¶”ê°€ë¨
  { name: 'ë¶„ì„', href: '/analytics', icon: BarChart3 },
  { name: 'ì¹´ë“œ ê´€ë¦¬', href: '/cards', icon: CreditCard },
  { name: 'ì‚¬ìš©ì ê´€ë¦¬', href: '/users', icon: Users },
  { name: 'íŒ¨í„´ ê´€ë¦¬', href: '/patterns', icon: Tag },
];
```

**ê¸°ëŠ¥**:
1. **ë°˜ì‘í˜•**: ë°ìŠ¤í¬íƒ‘(64px/256px), ëª¨ë°”ì¼(í–„ë²„ê±° ë©”ë‰´)
2. **ì ‘ê¸°/í¼ì¹˜ê¸°**: ChevronLeft/Right ì•„ì´ì½˜
3. **í™œì„± ìƒíƒœ**: í˜„ì¬ ê²½ë¡œ í•˜ì´ë¼ì´íŠ¸ (bg-blue-600)
4. **í…Œë§ˆ í† ê¸€**: ë‹¤í¬ëª¨ë“œ ì „í™˜
5. **ë²„ì „ í‘œì‹œ**: í•˜ë‹¨ì— v2.1.0

#### 6.1.2 `ChatSidebar.tsx` - ìš°ì¸¡ AI ì±„íŒ…

**íŠ¹ì§•**:
- **ê³ ì • ë„ˆë¹„**: 800px (ìµœì†Œí™” ì‹œ 0px)
- **í•­ìƒ í‘œì‹œ**: ëª¨ë“  í˜ì´ì§€ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥
- **ìŠ¤íŠ¸ë¦¬ë°**: Vercel AI SDKì˜ `useChat` ì‚¬ìš©
- **ëŒ€í™” ì´ˆê¸°í™”**: ë²„íŠ¼ìœ¼ë¡œ messages ë°°ì—´ ë¦¬ì…‹

**ìƒíƒœ ê´€ë¦¬**:
```tsx
const [messages, setMessages] = useState<Message[]>([]);
const [input, setInput] = useState('');
const [isMinimized, setIsMinimized] = useState(false);
const [isSettingsOpen, setIsSettingsOpen] = useState(false);
```

**API í˜¸ì¶œ**:
```tsx
const { append, isLoading } = useChat({
  api: '/api/assistant',
  body: {
    provider: aiSettings.provider,
    model: aiSettings.model,
    apiKey: aiSettings.apiKey,
  },
});
```

### 6.2 UI ì»´í¬ë„ŒíŠ¸

#### 6.2.1 `Autocomplete.tsx` - ìë™ì™„ì„± ì…ë ¥

**ì‚¬ìš©ì²˜**:
- ê±°ë˜ ë§¤ì¹­ ì‹œ ì‚¬ìš©ë‚´ì—­ ì…ë ¥
- íŒ¨í„´ ìƒì„± ì‹œ ì‚¬ìš©ë‚´ì—­ ì…ë ¥

**ê¸°ëŠ¥**:
1. **íƒ€ì´í•‘ í•„í„°ë§**: ì…ë ¥ê°’ì— ë”°ë¼ ì˜µì…˜ í•„í„°
2. **ì¹´í…Œê³ ë¦¬ ê·¸ë£¹**: "ìì£¼ ì‚¬ìš©", "íŒ¨í„´"ìœ¼ë¡œ êµ¬ë¶„
3. **í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜**: í™”ì‚´í‘œ í‚¤ë¡œ ì´ë™, Enterë¡œ ì„ íƒ
4. **í•˜ì´ë¼ì´íŠ¸**: ë§¤ì¹­ëœ í…ìŠ¤íŠ¸ êµµê²Œ í‘œì‹œ

```tsx
<Autocomplete
  value={usageDescription}
  onChange={setUsageDescription}
  options={[
    { value: 'ì‹ë¹„', label: 'ì‹ë¹„', category: 'ìì£¼ ì‚¬ìš©' },
    { value: 'êµí†µë¹„', label: 'êµí†µë¹„', category: 'ìì£¼ ì‚¬ìš©' },
    { value: 'ì»¤í”¼ êµ¬ì…', label: 'ì»¤í”¼ êµ¬ì…', category: 'íŒ¨í„´' },
  ]}
  placeholder="ì‚¬ìš©ë‚´ì—­ ì…ë ¥..."
/>
```

#### 6.2.2 `Badge.tsx` - ìƒíƒœ ë±ƒì§€

**ì‚¬ìš©ì²˜**:
- ê±°ë˜ ìƒíƒœ í‘œì‹œ (pending, matched)
- ì„¸ê¸ˆ ë¶„ë¥˜ í‘œì‹œ (11ê°œ ì¹´í…Œê³ ë¦¬)

**ìƒ‰ìƒ ë§¤í•‘** (ì„¸ê¸ˆ ë¶„ë¥˜):
```tsx
const TAX_CATEGORY_COLORS = {
  'ì ‘ëŒ€ë¹„': 'bg-purple-100 text-purple-800',
  'ì—…ë¬´ì¶”ì§„ë¹„': 'bg-blue-100 text-blue-800',
  'ë³µë¦¬í›„ìƒë¹„': 'bg-green-100 text-green-800',
  'ì†Œëª¨í’ˆë¹„': 'bg-yellow-100 text-yellow-800',
  'ì°¨ëŸ‰ìœ ë¥˜ë¹„': 'bg-orange-100 text-orange-800',
  'êµí†µë¹„': 'bg-teal-100 text-teal-800',
  'í†µì‹ ë¹„': 'bg-indigo-100 text-indigo-800',
  'ì‹ë¹„': 'bg-pink-100 text-pink-800',
  'íšŒì˜ë¹„': 'bg-cyan-100 text-cyan-800',
  'êµìœ¡í›ˆë ¨ë¹„': 'bg-lime-100 text-lime-800',
  'ê¸°íƒ€': 'bg-gray-100 text-gray-800',
};
```

---

## 7. ë°ì´í„° íë¦„

### 7.1 ê±°ë˜ ì¡°íšŒ íë¦„

```
ì‚¬ìš©ìê°€ /transactions ì ‘ì†
   â†“
TransactionsPage ì»´í¬ë„ŒíŠ¸ ë Œë”ë§
   â†“
useTransactions() Hook í˜¸ì¶œ
   â†“
React Query: queryKey ['transactions', params]
   â†“
Cache Hit? â†’ ìºì‹œ ë°˜í™˜
   â†“ (Cache Miss)
transactionsApi.getAll(params) í˜¸ì¶œ
   â†“
Supabase Query:
   SELECT * FROM transactions
   WHERE card_id = ? OR status = ?
   ORDER BY transaction_date DESC
   â†“
Response: Transaction[]
   â†“
React Query ìºì‹œ ì €ì¥
   â†“
ì»´í¬ë„ŒíŠ¸ ë¦¬ë Œë”ë§
   â†“
í…Œì´ë¸”ì— ê±°ë˜ ëª©ë¡ í‘œì‹œ
```

### 7.2 ë§¤ì¹­ ì²˜ë¦¬ íë¦„

```
ì‚¬ìš©ìê°€ 'ë§¤ì¹­' ë²„íŠ¼ í´ë¦­
   â†“
MatchModal ì—´ë¦¼
   â†“
ì‚¬ìš©ìê°€ í¼ ì…ë ¥
   - ì‚¬ìš©ë‚´ì—­ (í•„ìˆ˜)
   - ì¶”ê°€ë©”ëª¨ (ì„ íƒ)
   - ì„¸ê¸ˆë¶„ë¥˜ (ì„ íƒ ë˜ëŠ” ìë™)
   â†“
'ì €ì¥' ë²„íŠ¼ í´ë¦­
   â†“
handleMatch() í•¨ìˆ˜ í˜¸ì¶œ
   â†“
matchTransaction.mutate({
  id,
  usageDescription,
  additionalNotes,
  taxCategory,
})
   â†“
React Query Mutation
   â†“
transactionsApi.match(id, ...) í˜¸ì¶œ
   â†“
Supabase RPC:
   UPDATE transactions
   SET
     usage_description = ?,
     additional_notes = ?,
     tax_category = ?,
     status = 'matched',
     matched_at = NOW()
   WHERE id = ?
   â†“
Response: Updated Transaction
   â†“
onSuccess: queryClient.invalidateQueries(['transactions'])
   â†“
React Query ìºì‹œ ë¬´íš¨í™”
   â†“
useTransactions() ìë™ ë¦¬í˜ì¹­
   â†“
ì»´í¬ë„ŒíŠ¸ ë¦¬ë Œë”ë§
   â†“
UI ì—…ë°ì´íŠ¸ (status: matched, ì»¬ëŸ¼ ì±„ì›Œì§)
```

### 7.3 AI ì±„íŒ… íë¦„

```
ì‚¬ìš©ìê°€ ChatSidebarì— ë©”ì‹œì§€ ì…ë ¥
   â†“
handleSubmit() í˜¸ì¶œ
   â†“
append({ role: 'user', content: input })
   â†“
POST /api/assistant
   body: {
     messages: [...],
     provider: 'deepseek',
     model: 'deepseek-chat',
     apiKey: 'sk-...',
   }
   â†“
API Route: route.ts
   â†“
AI í”„ë¡œë°”ì´ë” ì´ˆê¸°í™”
   - createOpenRouter({ apiKey })
   â†“
streamText({
  model: openrouter(model),
  messages,
  system: "...",
})
   â†“
ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ ì‹œì‘
   â†“
Vercel AI SDK: useChat
   - onChunk: ì²­í¬ ìˆ˜ì‹ 
   - onFinish: ì™„ë£Œ ì‹œ ë©”ì‹œì§€ ì¶”ê°€
   â†“
ChatSidebar ë¦¬ë Œë”ë§
   â†“
ë©”ì‹œì§€ í‘œì‹œ (AssistantMessage)
```

---

## 8. íŒ¨í„´ ë§¤ì¹­ ì‹œìŠ¤í…œ

### 8.1 4ë‹¨ê³„ ë§¤ì¹­ ë¡œì§

```
ìƒˆ ê±°ë˜ ì—…ë¡œë“œ
   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1ë‹¨ê³„: ì •í™• ì¼ì¹˜ ë£©ì—…             â”‚
â”‚ - merchant_pattern = merchant_nameâ”‚
â”‚ - match_type = 'exact'            â”‚
â”‚ - priority DESC                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“ (ë¯¸ë§¤ì¹­ ì‹œ)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2ë‹¨ê³„: ìœ ì‚¬ ë§¤ì¹­ (Fuzzy)          â”‚
â”‚ - Levenshtein Distance < 3       â”‚
â”‚ - í¸ì§‘ ê±°ë¦¬ ê¸°ë°˜ ìœ ì‚¬ë„ ê³„ì‚°       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“ (ë¯¸ë§¤ì¹­ ì‹œ)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3ë‹¨ê³„: ê·œì¹™ ê¸°ë°˜ ë§¤ì¹­ (í¬í•¨)       â”‚
â”‚ - merchant_name LIKE '%pattern%'  â”‚
â”‚ - match_type = 'contains'         â”‚
â”‚ - priority DESC                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“ (ë¯¸ë§¤ì¹­ ì‹œ)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4ë‹¨ê³„: ì—…ì¢… ê¸°ë°˜ ìë™ ë§¤ì¹­         â”‚
â”‚ - industry_type â†’ usage ë§¤í•‘     â”‚
â”‚ - INDUSTRY_TO_USAGE í…Œì´ë¸” ì°¸ì¡°   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
ë§¤ì¹­ ì™„ë£Œ or ìˆ˜ë™ ì…ë ¥ ëŒ€ê¸°
```

### 8.2 ìš°ì„ ìˆœìœ„ ì‹œìŠ¤í…œ

| Priority | ì„¤ëª… | ì˜ˆì‹œ |
|----------|------|------|
| **10** | ì¹´ë“œ ì „ìš© íŒ¨í„´ | card_id = 1, pattern = "ìŠ¤íƒ€ë²…ìŠ¤" â†’ "ì»¤í”¼ êµ¬ì…" |
| **5** | í¬í•¨ ë§¤ì¹­ íŒ¨í„´ | pattern = "GS25%" â†’ "í¸ì˜ì  êµ¬ì…" |
| **0** | ì •í™• ë§¤ì¹­ íŒ¨í„´ | pattern = "ìŠ¤íƒ€ë²…ìŠ¤ ê°•ë‚¨ì " â†’ "ì»¤í”¼ êµ¬ì…" |

**ì²˜ë¦¬ ìˆœì„œ**:
1. Priority 10 (ì¹´ë“œ ì „ìš©) ë¨¼ì € í™•ì¸
2. Priority 5 (í¬í•¨ ë§¤ì¹­) í™•ì¸
3. Priority 0 (ì •í™• ë§¤ì¹­) í™•ì¸

### 8.3 íŒ¨í„´ ìƒì„± ê·œì¹™

#### 8.3.1 ìë™ ìƒì„± (ìˆ˜ë™ ë§¤ì¹­ ì‹œ)

```
ì‚¬ìš©ìê°€ ê±°ë˜ ìˆ˜ë™ ë§¤ì¹­
   â†“
Modalì—ì„œ 'íŒ¨í„´ìœ¼ë¡œ ì €ì¥' ì²´í¬
   â†“
ë§¤ì¹­ ì €ì¥ í›„ íŒ¨í„´ ìƒì„±
   â†“
patternsApi.create({
  card_id: null,           // ì „ì²´ ì ìš©
  merchant_pattern: merchant_name,
  usage_description: usageDescription,
  match_type: 'exact',
  priority: 0,
})
   â†“
ë‹¤ìŒ ì—…ë¡œë“œ ì‹œ ìë™ ë§¤ì¹­ë¨
```

#### 8.3.2 ìˆ˜ë™ ìƒì„± (/patterns í˜ì´ì§€)

```
/patterns í˜ì´ì§€ ì ‘ì†
   â†“
'íŒ¨í„´ ì¶”ê°€' ë²„íŠ¼ í´ë¦­
   â†“
Modal ì—´ë¦¼
   - ê°€ë§¹ì  íŒ¨í„´ ì…ë ¥ (ì˜ˆ: "GS25")
   - ì‚¬ìš©ë‚´ì—­ ì…ë ¥ (ì˜ˆ: "í¸ì˜ì  êµ¬ì…")
   - ë§¤ì¹­ ë°©ì‹ ì„ íƒ (ì •í™•/í¬í•¨)
   - ì¹´ë“œ ì„ íƒ (ì „ì²´/íŠ¹ì • ì¹´ë“œ)
   â†“
'ì €ì¥' ë²„íŠ¼ í´ë¦­
   â†“
patternsApi.create({...})
   â†“
íŒ¨í„´ ëª©ë¡ì— ì¶”ê°€
```

### 8.4 íŒ¨í„´ ê´€ë¦¬ ê¸°ëŠ¥

1. **ëª©ë¡ ì¡°íšŒ**: ì „ì²´ íŒ¨í„´ ëª©ë¡ + í†µê³„
2. **ìƒì„±**: ìƒˆ íŒ¨í„´ ì¶”ê°€
3. **ìˆ˜ì •**: ê¸°ì¡´ íŒ¨í„´ í¸ì§‘
4. **ì‚­ì œ**: ê°œë³„ ë˜ëŠ” ì¼ê´„ ì‚­ì œ
5. **í†µê³„**: ì‚¬ìš© íšŸìˆ˜, ë§ˆì§€ë§‰ ì‚¬ìš©ì¼ í‘œì‹œ

---

## 9. ì„¸ê¸ˆ ë¶„ë¥˜ ì‹œìŠ¤í…œ

### 9.1 ë¶„ë¥˜ ì¹´í…Œê³ ë¦¬ (11ê°œ)

| ì¹´í…Œê³ ë¦¬ | ì„¤ëª… | í‚¤ì›Œë“œ ì˜ˆì‹œ |
|---------|------|------------|
| **ì ‘ëŒ€ë¹„** | ê³ ê° ì ‘ëŒ€, ê±°ë˜ì²˜ íšŒì‹ | í˜¸í…”, ê³¨í”„, ê³ ê¸‰ ì‹ë‹¹ |
| **ì—…ë¬´ì¶”ì§„ë¹„** | íšŒì˜, ë¯¸íŒ… ê´€ë ¨ ë¹„ìš© | íšŒì˜ì‹¤, ë¯¸íŒ…ë£¸ |
| **ë³µë¦¬í›„ìƒë¹„** | ì§ì› ë³µì§€ ê´€ë ¨ ë¹„ìš© | í—¬ìŠ¤, ë³‘ì›, ê±´ê°•ê²€ì§„ |
| **ì†Œëª¨í’ˆë¹„** | ì‚¬ë¬´ìš©í’ˆ, ë¹„í’ˆ | ë¬¸êµ¬, ë‹¤ì´ì†Œ, ì‚¬ë¬´ìš©í’ˆ |
| **ì°¨ëŸ‰ìœ ë¥˜ë¹„** | ì°¨ëŸ‰ ì£¼ìœ  ë¹„ìš© | ì£¼ìœ , GSì¹¼í…ìŠ¤, S-OIL |
| **êµí†µë¹„** | ì¶œì¥, ì´ë™ ë¹„ìš© | íƒì‹œ, ë²„ìŠ¤, KTX |
| **í†µì‹ ë¹„** | ì „í™”, ì¸í„°ë„· ë¹„ìš© | SKT, KT, LGìœ í”ŒëŸ¬ìŠ¤ |
| **ì‹ë¹„** | ì¼ë°˜ ì‹ì‚¬ ë¹„ìš© | ì‹ë‹¹, ì¹´í˜, í¸ì˜ì  |
| **íšŒì˜ë¹„** | íšŒì˜ ê´€ë ¨ ë¹„ìš© | íšŒì˜ì‹¤, ì„¸ë¯¸ë‚˜ |
| **êµìœ¡í›ˆë ¨ë¹„** | êµìœ¡, ì—°ìˆ˜ ë¹„ìš© | êµìœ¡, í•™ì›, ê°•ì˜ |
| **ê¸°íƒ€** | ìœ„ ë¶„ë¥˜ ì™¸ | - |

### 9.2 ìë™ ë¶„ë¥˜ ì•Œê³ ë¦¬ì¦˜

#### 9.2.1 ìš°ì„ ìˆœìœ„

```
1. ì‚¬ìš©ìš©ë„(usage_description) í‚¤ì›Œë“œ ë§¤ì¹­
   â†“ (ë¯¸ë§¤ì¹­ ì‹œ)
2. ê°€ë§¹ì ëª…(merchant_name) í‚¤ì›Œë“œ ë§¤ì¹­
   â†“ (ë¯¸ë§¤ì¹­ ì‹œ)
3. ê¸ˆì•¡(amount) ê¸°ë°˜ ì¶”ë¡ 
   - 1,000,000ì› ì´ìƒ â†’ ì ‘ëŒ€ë¹„
   - 10,000ì› ì´í•˜ + í¸ì˜ì  â†’ ì†Œëª¨í’ˆë¹„
   â†“ (ë¯¸ë§¤ì¹­ ì‹œ)
4. ê¸°ë³¸ê°’: ê¸°íƒ€
```

#### 9.2.2 ê·œì¹™ ì˜ˆì‹œ

```tsx
// ì ‘ëŒ€ë¹„
{
  merchant: ['í˜¸í…”', 'ë¦¬ì¡°íŠ¸', 'ê³¨í”„', 'ê³ ê¸‰', 'í”„ë¦¬ë¯¸ì—„'],
  usage: ['ì ‘ëŒ€', 'ê±°ë˜ì²˜', 'ê³ ê°', 'íšŒì‹'],
  amountRange: { min: 50000 },
}

// ì‹ë¹„
{
  merchant: ['ì‹ë‹¹', 'ìŒì‹', 'ì¹´í˜', 'ìŠ¤íƒ€ë²…ìŠ¤', 'ë§¥ë„ë‚ ë“œ'],
  usage: ['ì‹ì‚¬', 'ì ì‹¬', 'ì €ë…', 'ì»¤í”¼', 'ê°„ì‹'],
}

// ì°¨ëŸ‰ìœ ë¥˜ë¹„
{
  merchant: ['ì£¼ìœ ', 'gsì¹¼í…ìŠ¤', 's-oil', 'skì—ë„ˆì§€'],
  usage: ['ì£¼ìœ ', 'ê²½ìœ ', 'íœ˜ë°œìœ ', 'ìœ ë¥˜'],
}
```

### 9.3 ìˆ˜ë™ ë¶„ë¥˜

ì‚¬ìš©ìê°€ ë§¤ì¹­ ëª¨ë‹¬ì—ì„œ ì§ì ‘ ì„ íƒ ê°€ëŠ¥:

```tsx
<select value={taxCategory} onChange={setTaxCategory}>
  <option value="">ìë™ ë¶„ë¥˜</option>
  <option value="ì ‘ëŒ€ë¹„">ì ‘ëŒ€ë¹„</option>
  <option value="ì—…ë¬´ì¶”ì§„ë¹„">ì—…ë¬´ì¶”ì§„ë¹„</option>
  <option value="ë³µë¦¬í›„ìƒë¹„">ë³µë¦¬í›„ìƒë¹„</option>
  <option value="ì†Œëª¨í’ˆë¹„">ì†Œëª¨í’ˆë¹„</option>
  <option value="ì°¨ëŸ‰ìœ ë¥˜ë¹„">ì°¨ëŸ‰ìœ ë¥˜ë¹„</option>
  <option value="êµí†µë¹„">êµí†µë¹„</option>
  <option value="í†µì‹ ë¹„">í†µì‹ ë¹„</option>
  <option value="ì‹ë¹„">ì‹ë¹„</option>
  <option value="íšŒì˜ë¹„">íšŒì˜ë¹„</option>
  <option value="êµìœ¡í›ˆë ¨ë¹„">êµìœ¡í›ˆë ¨ë¹„</option>
  <option value="ê¸°íƒ€">ê¸°íƒ€</option>
</select>
```

### 9.4 UI í‘œì‹œ

```tsx
// ê±°ë˜ í…Œì´ë¸”
{transaction.tax_category ? (
  <Badge className={TAX_CATEGORY_COLORS[transaction.tax_category]}>
    {transaction.tax_category}
  </Badge>
) : (
  <span className="text-xs text-gray-400 italic">ë¯¸ë¶„ë¥˜</span>
)}

// ì—‘ì…€ ë‚´ë³´ë‚´ê¸°
worksheet.addRow({
  ...
  tax: tx.tax_category || '',
});
```

---

## 10. AI í†µí•© êµ¬ì¡°

### 10.1 AI í”„ë¡œë°”ì´ë” ì„¤ì •

#### 10.1.1 ì§€ì› í”„ë¡œë°”ì´ë”

```tsx
export const AI_PROVIDERS = [
  {
    id: 'deepseek',
    name: 'DeepSeek',
    models: ['deepseek-chat', 'deepseek-coder'],
    pricing: { input: 0.28, output: 0.42 },
    features: ['ì €ë ´í•œ ê°€ê²©', 'í•©ë¦¬ì  ì„±ëŠ¥'],
  },
  {
    id: 'openai',
    name: 'OpenAI',
    models: ['gpt-4o', 'gpt-4o-mini'],
    pricing: { input: 2.50, output: 10.00 },
    features: ['ë©€í‹°ëª¨ë‹¬', 'ë†’ì€ ì •í™•ë„'],
  },
  {
    id: 'anthropic',
    name: 'Anthropic',
    models: ['claude-sonnet-4-20250514', 'claude-haiku-3-5'],
    pricing: { input: 3.00, output: 15.00 },
    features: ['ê¸´ ì»¨í…ìŠ¤íŠ¸', 'ì¶”ë¡  ëŠ¥ë ¥'],
  },
  {
    id: 'openrouter',
    name: 'OpenRouter',
    models: ['openai/gpt-4', 'anthropic/claude-3.5-sonnet', ...],
    pricing: { varies: true },
    features: ['400+ ëª¨ë¸', 'ë©€í‹° í”„ë¡œë°”ì´ë”'],
  },
];
```

#### 10.1.2 ì„¤ì • ëª¨ë“œ

**1. ì„œë²„ ì„¤ì • ì‚¬ìš© (ê¶Œì¥)**
- `.env.local`ì— API í‚¤ ì €ì¥
- í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì…ë ¥ ë¶ˆí•„ìš”
- ë³´ì•ˆì„± ë†’ìŒ

```bash
# .env.local
DEEPSEEK_API_KEY=sk-...
OPENAI_API_KEY=sk-...
ANTHROPIC_API_KEY=sk-ant-...
```

**2. ì§ì ‘ ì…ë ¥**
- í´ë¼ì´ì–¸íŠ¸ì—ì„œ API í‚¤ ì…ë ¥
- LocalStorageì— ì €ì¥
- ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥

```tsx
// AISettingsModal.tsx
<input
  type="password"
  value={apiKey}
  onChange={(e) => setApiKey(e.target.value)}
  placeholder="API í‚¤ ì…ë ¥..."
/>
```

### 10.2 ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸

```
ë‹¹ì‹ ì€ ì¹ ì¹ ê¸°ì—… ë²•ì¸ì¹´ë“œ ê´€ë¦¬ ì‹œìŠ¤í…œì˜ AI ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤.

ì£¼ìš” ê¸°ëŠ¥:
1. ê±°ë˜ ë‚´ì—­ ì¡°íšŒ
   - íŠ¹ì • ì¹´ë“œì˜ ê±°ë˜ ì¡°íšŒ
   - ê¸°ê°„ë³„ ê±°ë˜ ì¡°íšŒ
   - ê°€ë§¹ì ë³„ ê±°ë˜ ì¡°íšŒ
   - ë¯¸ë§¤ì¹­ ê±°ë˜ ì¡°íšŒ

2. íŒ¨í„´ ë§¤ì¹­ ì§€ì›
   - íŒ¨í„´ ìƒì„± ê°€ì´ë“œ
   - íŒ¨í„´ ìˆ˜ì • ì œì•ˆ
   - ë§¤ì¹­ ê·œì¹™ ì„¤ëª…

3. ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ìš”ì²­
   - ê¸°ê°„ ì§€ì • ë‹¤ìš´ë¡œë“œ ì•ˆë‚´
   - íŒŒì¼ í˜•ì‹ ì„¤ëª…

4. ë¶„ì„ ë¦¬í¬íŠ¸ ìƒì„±
   - ì›”ë³„ ì§€ì¶œ ë¶„ì„
   - ì¹´ë“œë³„ ì‚¬ìš© í˜„í™©
   - ì¹´í…Œê³ ë¦¬ë³„ í†µê³„

ë°ì´í„°ë² ì´ìŠ¤ ì •ë³´:
- users: ì‚¬ìš©ì ì •ë³´ (id, name, email, department)
- cards: ë²•ì¸ì¹´ë“œ ì •ë³´ (id, card_number, user_id, card_name)
- transactions: ê±°ë˜ ë‚´ì—­ (id, card_id, transaction_date, merchant_name, amount, usage_description, additional_notes, tax_category, status)
- patterns: íŒ¨í„´ ë§¤ì¹­ ê·œì¹™ (id, card_id, merchant_pattern, usage_description, match_type, priority)
- sessions: ì—…ë¡œë“œ ì„¸ì…˜ (id, file_name, total_count, matched_count)

ì„¸ê¸ˆ ë¶„ë¥˜ ì¹´í…Œê³ ë¦¬ (11ê°œ):
ì ‘ëŒ€ë¹„, ì—…ë¬´ì¶”ì§„ë¹„, ë³µë¦¬í›„ìƒë¹„, ì†Œëª¨í’ˆë¹„, ì°¨ëŸ‰ìœ ë¥˜ë¹„, êµí†µë¹„, í†µì‹ ë¹„, ì‹ë¹„, íšŒì˜ë¹„, êµìœ¡í›ˆë ¨ë¹„, ê¸°íƒ€

v3.1 ì‹ ê·œ ê¸°ëŠ¥:
- ì¶”ê°€ë©”ëª¨: ë‚´ë¶€ ê´€ë¦¬ìš© ì„ íƒ ì…ë ¥ (ì˜ˆ: "ì ì‹¬ë¹µ ë¨¹ëŠë¼ê³  í•œ ê±°")
- ì„¸ê¸ˆë¶„ë¥˜: 11ê°œ ì¹´í…Œê³ ë¦¬ ìë™ ë¶„ë¥˜ (ë£° ê¸°ë°˜)
- ì—‘ì…€ 6ì»¬ëŸ¼ ì§€ì› (ì‚¬ìš©ìš©ë„ + ì¶”ê°€ë©”ëª¨ + ì„¸ê¸ˆë¶„ë¥˜)

í•­ìƒ ì¹œì ˆí•˜ê³  ì •í™•í•˜ê²Œ ë‹µë³€í•˜ì„¸ìš”. í•œêµ­ì–´ë¡œ ë‹µë³€í•˜ì„¸ìš”.
```

### 10.3 AI ëŒ€í™” ì˜ˆì‹œ

**ì˜ˆì‹œ 1: ê±°ë˜ ì¡°íšŒ**
```
User: ì´ë²ˆ ë‹¬ ê¹€ì¤€êµ ì¹´ë“œ ê±°ë˜ ë‚´ì—­ ì•Œë ¤ì¤˜
AI: ë„¤, ê¹€ì¤€êµ(ì¹´ë“œë²ˆí˜¸ 3987)ì˜ 2025ë…„ 1ì›” ê±°ë˜ ë‚´ì—­ì„ ì¡°íšŒí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

    ì´ 42ê±´, 1,250,000ì›
    - ë§¤ì¹­ ì™„ë£Œ: 35ê±´
    - ë¯¸ë§¤ì¹­: 7ê±´

    ì£¼ìš” ê°€ë§¹ì :
    - ìŠ¤íƒ€ë²…ìŠ¤: 15ê±´, 82,500ì›
    - GS25: 8ê±´, 96,000ì›
    - íƒì‹œ: 6ê±´, 120,000ì›

    ë¯¸ë§¤ì¹­ ê±°ë˜ë¥¼ í™•ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?
```

**ì˜ˆì‹œ 2: íŒ¨í„´ ë§¤ì¹­ ìš”ì²­**
```
User: ìŠ¤íƒ€ë²…ìŠ¤ëŠ” ì•ìœ¼ë¡œ ìë™ìœ¼ë¡œ "ì»¤í”¼ êµ¬ì…"ìœ¼ë¡œ ë§¤ì¹­í•´ì¤˜
AI: ì•Œê² ìŠµë‹ˆë‹¤. "ìŠ¤íƒ€ë²…ìŠ¤" íŒ¨í„´ì„ "ì»¤í”¼ êµ¬ì…"ìœ¼ë¡œ ì €ì¥í•˜ê² ìŠµë‹ˆë‹¤.

    íŒ¨í„´ ì •ë³´:
    - ê°€ë§¹ì  íŒ¨í„´: ìŠ¤íƒ€ë²…ìŠ¤
    - ì‚¬ìš©ë‚´ì—­: ì»¤í”¼ êµ¬ì…
    - ë§¤ì¹­ ë°©ì‹: í¬í•¨ (LIKE '%ìŠ¤íƒ€ë²…ìŠ¤%')
    - ì ìš© ë²”ìœ„: ì „ì²´ ì¹´ë“œ

    ì´ì œ "ìŠ¤íƒ€ë²…ìŠ¤"ê°€ í¬í•¨ëœ ê°€ë§¹ì ì€ ìë™ìœ¼ë¡œ "ì»¤í”¼ êµ¬ì…"ìœ¼ë¡œ ë§¤ì¹­ë©ë‹ˆë‹¤.
```

**ì˜ˆì‹œ 3: ì—‘ì…€ ë‹¤ìš´ë¡œë“œ**
```
User: ì§€ë‚œ ë‹¬ ê±°ë˜ ë‚´ì—­ ì—‘ì…€ë¡œ ë‹¤ìš´ë°›ê³  ì‹¶ì–´
AI: ë„¤, 2024ë…„ 12ì›” ê±°ë˜ ë‚´ì—­ì„ ì—‘ì…€ë¡œ ë‹¤ìš´ë¡œë“œí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

    /export í˜ì´ì§€ë¡œ ì´ë™í•˜ì‹œë©´:
    1. "ì§€ë‚œ ë‹¬" ë²„íŠ¼ í´ë¦­
    2. "ë‹¤ìš´ë¡œë“œ" ë²„íŠ¼ í´ë¦­

    íŒŒì¼ í˜•ì‹:
    - íŒŒì¼ëª…: transactions_202412.xlsx
    - ì»¬ëŸ¼: ê²°ì œì¼ì, ê°€ë§¹ì ëª…, ì´ìš©ê¸ˆì•¡, ì‚¬ìš©ìš©ë„, ì¶”ê°€ë©”ëª¨, ì„¸ê¸ˆë¶„ë¥˜
    - ë°ì´í„°: ë§¤ì¹­ ì™„ë£Œëœ ê±°ë˜ë§Œ í¬í•¨

    ë°”ë¡œ ì´ë™í•˜ì‹œê² ìŠµë‹ˆê¹Œ?
```

---

## 11. ë°°í¬ ë° í™˜ê²½ì„¤ì •

### 11.1 í™˜ê²½ë³€ìˆ˜ ì„¤ì •

#### 11.1.1 í•„ìˆ˜ í™˜ê²½ë³€ìˆ˜

```bash
# Supabase (í•„ìˆ˜)
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGc...

# AI í”„ë¡œë°”ì´ë” (ê¸°ë³¸ ê¶Œì¥: DeepSeek)
NEXT_PUBLIC_AI_PROVIDER=deepseek
NEXT_PUBLIC_AI_MODEL=deepseek-chat

# API í‚¤ (ì„œë²„ ì‚¬ì´ë“œ - ê¶Œì¥)
DEEPSEEK_API_KEY=sk-...
OPENAI_API_KEY=sk-...
ANTHROPIC_API_KEY=sk-ant-...

# OpenRouter (ì„ íƒ)
NEXT_PUBLIC_OPENROUTER_API_KEY=sk-or-...
```

#### 11.1.2 í™˜ê²½ë³„ ì„¤ì •

**ë¡œì»¬ ê°œë°œ (`.env.local`)**:
```bash
NEXT_PUBLIC_SUPABASE_URL=https://dev-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=dev-key...
DEEPSEEK_API_KEY=sk-dev-...
```

**ë°°í¬ (Vercel)**:
- Vercel ëŒ€ì‹œë³´ë“œì—ì„œ Environment Variables ì„¤ì •
- Production, Preview, Development í™˜ê²½ë³„ ì„¤ì • ê°€ëŠ¥

### 11.2 Vercel ë°°í¬

#### 11.2.1 ë°°í¬ ì›Œí¬í”Œë¡œìš°

```
GitHubì— ì»¤ë°‹ í‘¸ì‹œ
   â†“
Vercel ìë™ ê°ì§€
   â†“
ë¹Œë“œ ì‹œì‘ (npm run build)
   â†“
Next.js ë¹Œë“œ
   - TypeScript ì»´íŒŒì¼
   - ì •ì  í˜ì´ì§€ ìƒì„± (SSG)
   - ìµœì í™” (ì´ë¯¸ì§€, í°íŠ¸)
   â†“
ë°°í¬ (Edge Network)
   - ì „ ì„¸ê³„ CDN ë°°í¬
   - ë„ë©”ì¸ ìë™ ì—°ê²°
   â†“
ì™„ë£Œ (1~2ë¶„ ì†Œìš”)
```

#### 11.2.2 ë°°í¬ ì„¤ì •

**vercel.json** (ì—†ìŒ, ê¸°ë³¸ ì„¤ì • ì‚¬ìš©)

**next.config.ts**:
```tsx
const nextConfig = {
  reactStrictMode: true,
  swcMinify: true,
  images: {
    domains: ['your-supabase-project.supabase.co'],
  },
};

export default nextConfig;
```

### 11.3 Supabase ì„¤ì •

#### 11.3.1 í”„ë¡œì íŠ¸ ìƒì„±

1. Supabase ëŒ€ì‹œë³´ë“œ ì ‘ì†
2. New Project í´ë¦­
3. í”„ë¡œì íŠ¸ ì´ë¦„, ë¹„ë°€ë²ˆí˜¸ ì„¤ì •
4. Region ì„ íƒ (Northeast Asia - Seoul)
5. ìƒì„± ì™„ë£Œ (2~3ë¶„ ì†Œìš”)

#### 11.3.2 í…Œì´ë¸” ìƒì„±

SQL Editorì—ì„œ ì‹¤í–‰:

```sql
-- users í…Œì´ë¸”
CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  name VARCHAR(100) NOT NULL,
  email VARCHAR(255),
  phone VARCHAR(20),
  department VARCHAR(100),
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

-- cards í…Œì´ë¸”
CREATE TABLE cards (
  id SERIAL PRIMARY KEY,
  card_number VARCHAR(4) NOT NULL UNIQUE,
  user_id INTEGER REFERENCES users(id),
  card_name VARCHAR(100),
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMP DEFAULT NOW()
);

-- transactions í…Œì´ë¸” (v3.1: ì¶”ê°€ë©”ëª¨, ì„¸ê¸ˆë¶„ë¥˜ í¬í•¨)
CREATE TABLE transactions (
  id SERIAL PRIMARY KEY,
  session_id INTEGER REFERENCES sessions(id) ON DELETE CASCADE,
  card_id INTEGER REFERENCES cards(id),
  transaction_date DATE NOT NULL,
  merchant_name VARCHAR(255) NOT NULL,
  merchant_code VARCHAR(50),
  industry_type VARCHAR(100),
  amount DECIMAL(12, 2) NOT NULL,
  usage_description TEXT,
  additional_notes TEXT,       -- v3.1 ì¶”ê°€
  tax_category VARCHAR(50),     -- v3.1 ì¶”ê°€
  status VARCHAR(20) DEFAULT 'pending',
  matched_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW()
);

-- patterns í…Œì´ë¸”
CREATE TABLE patterns (
  id SERIAL PRIMARY KEY,
  card_id INTEGER REFERENCES cards(id),
  merchant_pattern VARCHAR(255) NOT NULL,
  usage_description TEXT NOT NULL,
  match_type VARCHAR(20) DEFAULT 'exact',
  priority INTEGER DEFAULT 0,
  use_count INTEGER DEFAULT 0,
  last_used_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW()
);

-- sessions í…Œì´ë¸”
CREATE TABLE sessions (
  id SERIAL PRIMARY KEY,
  file_name VARCHAR(255) NOT NULL,
  uploaded_at TIMESTAMP DEFAULT NOW(),
  total_count INTEGER DEFAULT 0,
  matched_count INTEGER DEFAULT 0,
  pending_count INTEGER DEFAULT 0
);

-- ì¸ë±ìŠ¤ ìƒì„±
CREATE INDEX idx_transactions_session_id ON transactions(session_id);
CREATE INDEX idx_transactions_card_id ON transactions(card_id);
CREATE INDEX idx_transactions_status ON transactions(status);
CREATE INDEX idx_transactions_date ON transactions(transaction_date);
CREATE INDEX idx_patterns_card_id ON patterns(card_id);
CREATE INDEX idx_patterns_merchant ON patterns(merchant_pattern);
CREATE INDEX idx_patterns_priority ON patterns(priority DESC);
```

#### 11.3.3 RLS (Row Level Security) ì„¤ì •

**ë¹„í™œì„±í™” (í˜„ì¬)**:
- í˜„ì¬ëŠ” RLS ë¹„í™œì„±í™” ìƒíƒœ
- í–¥í›„ ì¸ì¦ ì¶”ê°€ ì‹œ RLS í™œì„±í™” ì˜ˆì •

---

## 12. ê°œë°œ íˆìŠ¤í† ë¦¬

### 12.1 ë²„ì „ë³„ ì£¼ìš” ë³€ê²½ì‚¬í•­

#### v3.1.1 (2025-01-16)
**ë³€ê²½ ì‚¬í•­**:
- Sidebar ë„¤ë¹„ê²Œì´ì…˜ ìˆ˜ì •: `/workspace` â†’ `/transactions`
- ì¤‘ë³µ í˜ì´ì§€ ì œê±°: `/workspace` í´ë” ì‚­ì œ (1,039ì¤„)
- ë©”ë‰´ êµ¬ì¡° ê°œì„ : ì—…ë¡œë“œ, ë‚´ë³´ë‚´ê¸° ë³„ë„ ë©”ë‰´ í•­ëª© ì¶”ê°€
- ë°°í¬ í™˜ê²½ ë™ê¸°í™”: ë¡œì»¬ê³¼ ë°°í¬ì—ì„œ ë™ì¼í•œ 10ê°œ ì»¬ëŸ¼ UI

**í•´ê²° ë¬¸ì œ**:
- ë°°í¬ í™˜ê²½ì—ì„œ ì¶”ê°€ë©”ëª¨, ì„¸ê¸ˆë¶„ë¥˜ ì»¬ëŸ¼ì´ ë³´ì´ì§€ ì•Šë˜ ë¬¸ì œ
- `/workspace` (êµ¬ë²„ì „, 8ì»¬ëŸ¼)ì™€ `/transactions` (ì‹ ë²„ì „, 10ì»¬ëŸ¼) ì¤‘ë³µ ì¡´ì¬
- Sidebarê°€ `/workspace`ë¥¼ ê°€ë¦¬ì¼œì„œ ì‹ ê¸°ëŠ¥ì— ì ‘ê·¼ ë¶ˆê°€

**íŒŒì¼ ë³€ê²½**:
- Modified: `frontend/src/components/layout/Sidebar.tsx`
- Deleted: `frontend/src/app/workspace/page.tsx`
- Deleted: `frontend/src/components/workspace/TransactionsPanel.tsx`
- Deleted: `frontend/src/components/workspace/UploadPanel.tsx`
- Deleted: `frontend/src/components/workspace/ExportPanel.tsx`
- Deleted: `frontend/src/components/workspace/index.ts`

#### v3.1 (2025-01-15)
**ë³€ê²½ ì‚¬í•­**:
- ê±°ë˜ ë°ì´í„° í™•ì¥: `additional_notes`, `tax_category` í•„ë“œ ì¶”ê°€
- ì—‘ì…€ 6ì»¬ëŸ¼ ì§€ì›: ê¸°ì¡´ 4ì»¬ëŸ¼ â†’ 6ì»¬ëŸ¼
- ë£° ê¸°ë°˜ ì„¸ê¸ˆ ìë™ ë¶„ë¥˜: 11ê°œ ì¹´í…Œê³ ë¦¬
- ë‚´ë¶€ ê´€ë¦¬ ê°•í™”: ì¶”ê°€ë©”ëª¨ ê¸°ëŠ¥
- ìƒˆ ì¹´ë“œ ì¶”ê°€: 0981, 9904

**íŒŒì¼ ë³€ê²½**:
- Modified: `frontend/src/app/transactions/page.tsx` (ì¶”ê°€ë©”ëª¨, ì„¸ê¸ˆë¶„ë¥˜ state ì¶”ê°€)
- Modified: `frontend/src/components/transactions/BatchMatchModal.tsx` (ì‹ ê·œ í•„ë“œ UI ì¶”ê°€)
- Modified: `frontend/src/hooks/useApi.ts` (useMatchTransaction íŒŒë¼ë¯¸í„° í™•ì¥)
- Modified: `frontend/src/lib/excel.ts` (6ì»¬ëŸ¼ ë‚´ë³´ë‚´ê¸°)
- Created: `frontend/src/lib/taxCategories.ts` (11ê°œ ì¹´í…Œê³ ë¦¬ ì •ì˜)
- Created: `frontend/src/lib/taxClassifier.ts` (ë£° ê¸°ë°˜ ë¶„ë¥˜ ì—”ì§„)
- Modified: Supabase `transactions` í…Œì´ë¸” (2ê°œ ì»¬ëŸ¼ ì¶”ê°€)

#### v3.0 (2025-01)
**ë³€ê²½ ì‚¬í•­**:
- ë©€í‹° AI í”„ë¡œë°”ì´ë” ì§€ì› (DeepSeek, OpenAI, Anthropic, OpenRouter)
- ì„œë²„ ì„¤ì • ëª¨ë“œ ì¶”ê°€ (API í‚¤ ì…ë ¥ ì—†ì´ ì‚¬ìš©)
- 4ë‹¨ê³„ íŒ¨í„´ ë§¤ì¹­ ë¡œì§ êµ¬í˜„
- AI ì‚¬ì´ë“œë°” ì±„íŒ… UI ê°œì„  (ê³ ì •í˜•, 800px)

**íŒŒì¼ ë³€ê²½**:
- Created: `frontend/src/components/chat-sidebar/` (ChatSidebar, AISettingsModal)
- Created: `frontend/src/lib/ai/` (openrouter-config.ts, settings-store.ts)
- Modified: `frontend/src/app/api/assistant/route.ts` (ë©€í‹° í”„ë¡œë°”ì´ë” ì§€ì›)
- Modified: `frontend/src/app/layout.tsx` (ChatSidebar ì¶”ê°€)

#### v2.0 (2024-12)
**ë³€ê²½ ì‚¬í•­**:
- Next.js 15 + Supabase ì•„í‚¤í…ì²˜ë¡œ ì „í™˜
- AI ì–´ì‹œìŠ¤í„´íŠ¸ ê¸°ëŠ¥ ì¶”ê°€
- ëŒ€ì‹œë³´ë“œ UI ê°œì„ 
- React Query ë„ì…

**íŒŒì¼ ë³€ê²½**:
- ì „ì²´ í”„ë¡œì íŠ¸ êµ¬ì¡° ë³€ê²½
- `frontend/` í´ë” ìƒì„±
- Supabase ì—°ë™

### 12.2 ì£¼ìš” ì´ìŠˆ ë° í•´ê²°

#### ì´ìŠˆ 1: ë°°í¬ í™˜ê²½ì—ì„œ ì‹ ê·œ ì»¬ëŸ¼ ë¯¸í‘œì‹œ (v3.1.1)
**ì¦ìƒ**:
- ë¡œì»¬: /transactions ì§ì ‘ ì ‘ì† ì‹œ 10ê°œ ì»¬ëŸ¼ í‘œì‹œ
- ë°°í¬: ë©”ë‰´ í´ë¦­ ì‹œ 8ê°œ ì»¬ëŸ¼ë§Œ í‘œì‹œ

**ì›ì¸**:
- Sidebarê°€ `/workspace` (êµ¬ë²„ì „)ë¥¼ ê°€ë¦¬í‚´
- `/workspace`ëŠ” TransactionsPanel (8ì»¬ëŸ¼) ì‚¬ìš©
- `/transactions`ëŠ” page.tsx (10ì»¬ëŸ¼) ì‚¬ìš©

**í•´ê²°**:
- Sidebar ë§í¬ë¥¼ `/transactions`ë¡œ ë³€ê²½
- `/workspace` í´ë” ë° ê´€ë ¨ ì»´í¬ë„ŒíŠ¸ ì‚­ì œ
- ì—…ë¡œë“œ, ë‚´ë³´ë‚´ê¸°ë¥¼ ë³„ë„ ë©”ë‰´ë¡œ ë¶„ë¦¬

#### ì´ìŠˆ 2: íŒ¨í„´ ë§¤ì¹­ ìš°ì„ ìˆœìœ„ (v3.0)
**ì¦ìƒ**:
- ì¹´ë“œ ì „ìš© íŒ¨í„´ì´ ë¬´ì‹œë˜ê³  ì¼ë°˜ íŒ¨í„´ì´ ì ìš©ë¨

**ì›ì¸**:
- Priority ì •ë ¬ ëˆ„ë½

**í•´ê²°**:
- SQLì— `ORDER BY priority DESC` ì¶”ê°€
- ì¹´ë“œ ì „ìš© íŒ¨í„´(priority: 10) ìš°ì„  ì ìš©

#### ì´ìŠˆ 3: ì—‘ì…€ íŒŒì‹± ì‹œ ë‚ ì§œ ì˜¤ë¥˜ (v2.0)
**ì¦ìƒ**:
- ë‚ ì§œê°€ ìˆ«ìë¡œ íŒŒì‹±ë¨ (ì˜ˆ: 45320)

**ì›ì¸**:
- Excel ë‚ ì§œëŠ” 1900-01-01 ê¸°ì¤€ ì¼ìˆ˜ë¡œ ì €ì¥ë¨

**í•´ê²°**:
```tsx
function parseExcelDate(value: any): Date {
  if (typeof value === 'number') {
    // Excel epoch: 1900-01-01
    const date = new Date((value - 25569) * 86400 * 1000);
    return date;
  }
  return new Date(value);
}
```

### 12.3 í–¥í›„ ê³„íš

#### Phase 6: ë¶„ì„ ë° ë¦¬í¬íŒ… ê³ ë„í™” (ì§„í–‰ ì¤‘)
- ì°¨íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ í™•ì¥ (Recharts)
- ì›”ë³„/ì¹´ë“œë³„/ì¹´í…Œê³ ë¦¬ë³„ ìƒì„¸ ë¶„ì„
- PDF ë¦¬í¬íŠ¸ ìƒì„±

#### Phase 7: ì¸ì¦ ë° ê¶Œí•œ ê´€ë¦¬
- Supabase Auth ë„ì…
- RLS (Row Level Security) í™œì„±í™”
- ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´ (RBAC)

#### Phase 8: ëª¨ë°”ì¼ ìµœì í™”
- ë°˜ì‘í˜• UI ê°œì„ 
- PWA (Progressive Web App) ì§€ì›
- ëª¨ë°”ì¼ ì•± (React Native)

#### Phase 9: ê³ ê¸‰ AI ê¸°ëŠ¥
- ê±°ë˜ ë‚´ì—­ ìë™ ìš”ì•½
- ì´ìƒ ê±°ë˜ íƒì§€
- ì˜ˆì‚° ì´ˆê³¼ ì•Œë¦¼
- íŒ¨í„´ ì¶”ì²œ AI

---

## 13. ì°¸ê³  ìë£Œ

### 13.1 ì™¸ë¶€ ë¬¸ì„œ

- [Next.js ê³µì‹ ë¬¸ì„œ](https://nextjs.org/docs)
- [Supabase ê³µì‹ ë¬¸ì„œ](https://supabase.com/docs)
- [Vercel AI SDK](https://sdk.vercel.ai/docs)
- [React Query](https://tanstack.com/query/latest)
- [Tailwind CSS](https://tailwindcss.com/docs)
- [ExcelJS](https://github.com/exceljs/exceljs)

### 13.2 ë‚´ë¶€ ë¬¸ì„œ

- `/home/tlswkehd/77inc/README.md` - í”„ë¡œì íŠ¸ ê°œìš”
- `/home/tlswkehd/77inc/claudedocs/AI_ìë™ë¶„ë¥˜_í”„ë¡œê·¸ë¨_ì„¤ê³„ì„œ.md` - AI ë¶„ë¥˜ ì„¤ê³„
- `/home/tlswkehd/77inc/claudedocs/ì¹´ë“œë¶„ë¥˜_ì‹œìŠ¤í…œ_ê°œì„ _ê³„íšì„œ.md` - ì‹œìŠ¤í…œ ê°œì„  ê³„íš
- `/home/tlswkehd/77inc/scripts/README.md` - ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš©ë²•

### 13.3 ì£¼ìš” ë§í¬

- **GitHub**: https://github.com/shinjadong/77inc
- **Vercel**: https://77inc.vercel.app (ë°°í¬ URL)
- **Supabase**: https://app.supabase.com/project/your-project

---

## 14. ìš©ì–´ ì •ë¦¬

| ìš©ì–´ | ì„¤ëª… |
|------|------|
| **ê±°ë˜ (Transaction)** | ë²•ì¸ì¹´ë“œë¡œ ê²°ì œí•œ 1ê±´ì˜ ê±°ë˜ ë‚´ì—­ |
| **ë§¤ì¹­ (Matching)** | ê±°ë˜ì— ì‚¬ìš©ë‚´ì—­ì„ ì—°ê²°í•˜ëŠ” ì‘ì—… |
| **íŒ¨í„´ (Pattern)** | ê°€ë§¹ì ëª…ê³¼ ì‚¬ìš©ë‚´ì—­ì„ ìë™ ì—°ê²°í•˜ëŠ” ê·œì¹™ |
| **ì„¸ì…˜ (Session)** | ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ 1íšŒ ë‹¨ìœ„ |
| **ì¶”ê°€ë©”ëª¨ (Additional Notes)** | ë‚´ë¶€ ê´€ë¦¬ìš© ì„ íƒ ì…ë ¥ í•„ë“œ (v3.1) |
| **ì„¸ê¸ˆë¶„ë¥˜ (Tax Category)** | 11ê°œ ì¹´í…Œê³ ë¦¬ ìë™ ë¶„ë¥˜ (v3.1) |
| **ì‚¬ìš©ë‚´ì—­ (Usage Description)** | ê±°ë˜ì˜ ëª©ì ì´ë‚˜ ìš©ë„ |
| **ê°€ë§¹ì  (Merchant)** | ê²°ì œê°€ ë°œìƒí•œ ìƒì  |
| **ì—…ì¢… (Industry Type)** | ê°€ë§¹ì ì˜ ì—…ì¢… (ìŒì‹ì , í¸ì˜ì  ë“±) |
| **Pending** | ë¯¸ë§¤ì¹­ ìƒíƒœ (ì‚¬ìš©ë‚´ì—­ ì…ë ¥ ëŒ€ê¸°) |
| **Matched** | ë§¤ì¹­ ì™„ë£Œ ìƒíƒœ |

---

## 15. íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### 15.1 ë¹Œë“œ ì—ëŸ¬

**ì—ëŸ¬**: `Type error: Property 'additionalNotes' does not exist`

**í•´ê²°**:
```bash
# TypeScript íƒ€ì… ì •ì˜ í™•ì¸
# frontend/src/types/index.ts

export interface Transaction {
  // ...
  additional_notes?: string;  // ì¶”ê°€
  tax_category?: string;      // ì¶”ê°€
}
```

### 15.2 Supabase ì—°ê²° ì—ëŸ¬

**ì—ëŸ¬**: `Supabase client not initialized`

**í•´ê²°**:
```bash
# .env.local í™•ì¸
NEXT_PUBLIC_SUPABASE_URL=https://...
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGc...

# Next.js ì„œë²„ ì¬ì‹œì‘
npm run dev
```

### 15.3 AI API ì—ëŸ¬

**ì—ëŸ¬**: `401 Unauthorized`

**í•´ê²°**:
```bash
# API í‚¤ í™•ì¸
DEEPSEEK_API_KEY=sk-...

# ë˜ëŠ” í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì§ì ‘ ì…ë ¥
# AI ì„¤ì • ëª¨ë‹¬ â†’ API í‚¤ ì…ë ¥
```

---

**ë¬¸ì„œ ë**

ì´ ë¬¸ì„œëŠ” í”„ë¡œì íŠ¸ì˜ ëª¨ë“  êµ¬ì¡°ì™€ ë™ì‘ ì›ë¦¬ë¥¼ ìƒì„¸íˆ ì„¤ëª…í•©ë‹ˆë‹¤. ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€ ì‹œ ì´ ë¬¸ì„œë¥¼ ì—…ë°ì´íŠ¸í•˜ì—¬ ì»¨í…ìŠ¤íŠ¸ë¥¼ ìœ ì§€í•˜ì„¸ìš”.

Â© 2025 ì¹ ì¹ ê¸°ì—…User: ì´ë²ˆ ë‹¬ ê¹€ì¤€êµ ì¹´ë“œ ê±°ë˜ ë‚´ì—­ ì•Œë ¤ì¤˜
